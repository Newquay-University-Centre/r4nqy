<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Fisher’s exact test | Data analysis for Newquay University Centre</title>
  <meta name="description" content="A work in progress" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Fisher’s exact test | Data analysis for Newquay University Centre" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://newquay-university-centre.github.io/r4nqy//images/logo/newquay_uc.png" />
  <meta property="og:description" content="A work in progress" />
  <meta name="github-repo" content="Newquay-University-Centre/r4nqy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Fisher’s exact test | Data analysis for Newquay University Centre" />
  
  <meta name="twitter:description" content="A work in progress" />
  <meta name="twitter:image" content="https://newquay-university-centre.github.io/r4nqy//images/logo/newquay_uc.png" />

<meta name="author" content="Michael Hunt" />


<meta name="date" content="2024-05-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chi-square.html"/>
<link rel="next" href="difference.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Newquay University Centre</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>0.1</b> Usage</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>0.2</b> Render book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>0.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html"><i class="fa fa-check"></i><b>1</b> Plot your data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#load-packages"><i class="fa fa-check"></i><b>1.1</b> Load packages</a></li>
<li class="chapter" data-level="1.2" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#get-the-template-script"><i class="fa fa-check"></i><b>1.2</b> Get the template script</a></li>
<li class="chapter" data-level="1.3" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#load-the-palmer-penguin-data"><i class="fa fa-check"></i><b>1.3</b> Load the Palmer penguin data</a></li>
<li class="chapter" data-level="1.4" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#summary-stats-on-all-the-numeric-columns"><i class="fa fa-check"></i><b>1.4</b> Summary stats on all the numeric columns</a></li>
<li class="chapter" data-level="1.5" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#remove-the-rows-with-nas"><i class="fa fa-check"></i><b>1.5</b> Remove the rows with NAs</a></li>
<li class="chapter" data-level="1.6" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#how-many-observations-are-there-for-each-species"><i class="fa fa-check"></i><b>1.6</b> How many observations are there for each species?</a></li>
<li class="chapter" data-level="1.7" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#mean-value-for-each-numerical-variable-for-each-species"><i class="fa fa-check"></i><b>1.7</b> Mean value for each numerical variable, for each species</a></li>
<li class="chapter" data-level="1.8" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>1.8</b> Scatter plots</a></li>
<li class="chapter" data-level="1.9" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#repeat-for-bill-length-and-flipper-length"><i class="fa fa-check"></i><b>1.9</b> Repeat for bill length and flipper length</a></li>
<li class="chapter" data-level="1.10" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#add-yet-more-informtion-to-the-plot"><i class="fa fa-check"></i><b>1.10</b> Add yet more informtion to the plot</a></li>
<li class="chapter" data-level="1.11" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#distribution-of-penguin-flipper-lengths"><i class="fa fa-check"></i><b>1.11</b> Distribution of penguin flipper lengths</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#histogram"><i class="fa fa-check"></i><b>1.11.1</b> Histogram</a></li>
<li class="chapter" data-level="1.11.2" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#density-plot"><i class="fa fa-check"></i><b>1.11.2</b> Density plot</a></li>
<li class="chapter" data-level="1.11.3" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>1.11.3</b> Box plots</a></li>
<li class="chapter" data-level="1.11.4" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#violin-plot-using-geom_violin"><i class="fa fa-check"></i><b>1.11.4</b> Violin Plot using <code>geom_violin()</code></a></li>
<li class="chapter" data-level="1.11.5" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#ridge-plot"><i class="fa fa-check"></i><b>1.11.5</b> Ridge plot</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#bar-chart-with-error-bar"><i class="fa fa-check"></i><b>1.12</b> Bar chart with error bar</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chi-square.html"><a href="chi-square.html"><i class="fa fa-check"></i><b>2</b> Chi-square analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chi-square.html"><a href="chi-square.html#chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>2.1</b> Chi-square goodness of fit test</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chi-square.html"><a href="chi-square.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="chi-square.html"><a href="chi-square.html#doing-the-chi-square-test-in-r"><i class="fa fa-check"></i><b>2.1.2</b> Doing the chi-square test in R</a></li>
<li class="chapter" data-level="2.1.3" data-path="chi-square.html"><a href="chi-square.html#reporting-the-result-in-english"><i class="fa fa-check"></i><b>2.1.3</b> Reporting the result in English</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chi-square.html"><a href="chi-square.html#exercise-1."><i class="fa fa-check"></i><b>2.2</b> Exercise 1.</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chi-square.html"><a href="chi-square.html#solution.-1"><i class="fa fa-check"></i><b>2.2.1</b> Solution. 1</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chi-square.html"><a href="chi-square.html#way-chi-square-analysis-test-of-independence"><i class="fa fa-check"></i><b>2.3</b> 2-way chi square analysis: test of independence</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chi-square.html"><a href="chi-square.html#hypotheses"><i class="fa fa-check"></i><b>2.3.1</b> Hypotheses</a></li>
<li class="chapter" data-level="2.3.2" data-path="chi-square.html"><a href="chi-square.html#summarise-the-data."><i class="fa fa-check"></i><b>2.3.2</b> Summarise the data.</a></li>
<li class="chapter" data-level="2.3.3" data-path="chi-square.html"><a href="chi-square.html#plot-the-data."><i class="fa fa-check"></i><b>2.3.3</b> Plot the data.</a></li>
<li class="chapter" data-level="2.3.4" data-path="chi-square.html"><a href="chi-square.html#interpret-the-graph-before-we-do-any-stats"><i class="fa fa-check"></i><b>2.3.4</b> Interpret the graph before we do any ‘stats’</a></li>
<li class="chapter" data-level="2.3.5" data-path="chi-square.html"><a href="chi-square.html#the-chi-square-test"><i class="fa fa-check"></i><b>2.3.5</b> The Chi-square test</a></li>
<li class="chapter" data-level="2.3.6" data-path="chi-square.html"><a href="chi-square.html#yates-continuity-correction"><i class="fa fa-check"></i><b>2.3.6</b> Yates continuity correction</a></li>
<li class="chapter" data-level="2.3.7" data-path="chi-square.html"><a href="chi-square.html#conclusion"><i class="fa fa-check"></i><b>2.3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chi-square.html"><a href="chi-square.html#the-chi-square-test-explained-advanced"><i class="fa fa-check"></i><b>2.4</b> The Chi-Square Test explained (advanced)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chi-square.html"><a href="chi-square.html#why-does-the-test-statistic-have-this-distribution"><i class="fa fa-check"></i><b>2.4.1</b> Why does the test statistic have this distribution?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html"><i class="fa fa-check"></i><b>3</b> Fisher’s exact test</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#the-hypergeometric-function"><i class="fa fa-check"></i><b>3.1</b> The Hypergeometric Function</a></li>
<li class="chapter" data-level="3.2" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#hypergeometric-distribution-in-r"><i class="fa fa-check"></i><b>3.2</b> Hypergeometric Distribution in R</a></li>
<li class="chapter" data-level="3.3" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#back-to-fishers-exact-test"><i class="fa fa-check"></i><b>3.3</b> Back to Fisher’s Exact Test</a></li>
<li class="chapter" data-level="3.4" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#example-1"><i class="fa fa-check"></i><b>3.4</b> Example</a></li>
<li class="chapter" data-level="3.5" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#fishers-exact-test-in-r"><i class="fa fa-check"></i><b>3.5</b> Fisher’s Exact Test in R</a></li>
<li class="chapter" data-level="3.6" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#what-if-we-just-use-a-chi-square-test"><i class="fa fa-check"></i><b>3.6</b> What if we just use a chi-square test?</a></li>
<li class="chapter" data-level="3.7" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#why-not-always-use-fishers-exact-test-instead-of-a-chi-square-test"><i class="fa fa-check"></i><b>3.7</b> Why not always use Fisher’s Exact Test instead of a chi-square test?</a></li>
<li class="chapter" data-level="3.8" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#another-cautionary-note"><i class="fa fa-check"></i><b>3.8</b> Another Cautionary Note</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="difference.html"><a href="difference.html"><i class="fa fa-check"></i><b>4</b> t-test for difference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="difference.html"><a href="difference.html#preliminaries"><i class="fa fa-check"></i><b>4.1</b> Preliminaries</a></li>
<li class="chapter" data-level="4.2" data-path="difference.html"><a href="difference.html#motivation-and-example"><i class="fa fa-check"></i><b>4.2</b> Motivation and example</a></li>
<li class="chapter" data-level="4.3" data-path="difference.html"><a href="difference.html#the-two-sample-t-test"><i class="fa fa-check"></i><b>4.3</b> The two-sample <em>t</em>-test</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="difference.html"><a href="difference.html#pros-of-the-t-test"><i class="fa fa-check"></i><b>4.3.1</b> Pros of the <em>t</em>-test</a></li>
<li class="chapter" data-level="4.3.2" data-path="difference.html"><a href="difference.html#cons-of-the-t-test"><i class="fa fa-check"></i><b>4.3.2</b> Cons of the <em>t</em>-test</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="difference.html"><a href="difference.html#the-workflow"><i class="fa fa-check"></i><b>4.4</b> The workflow</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="difference.html"><a href="difference.html#open-your-project"><i class="fa fa-check"></i><b>4.4.1</b> Open your project</a></li>
<li class="chapter" data-level="4.4.2" data-path="difference.html"><a href="difference.html#create-a-new-script"><i class="fa fa-check"></i><b>4.4.2</b> Create a new script</a></li>
<li class="chapter" data-level="4.4.3" data-path="difference.html"><a href="difference.html#load-packages-1"><i class="fa fa-check"></i><b>4.4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4.4" data-path="difference.html"><a href="difference.html#read-in-and-inspect-the-data"><i class="fa fa-check"></i><b>4.4.4</b> Read in and inspect the data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="difference.html"><a href="difference.html#step-one-summarise-the-data"><i class="fa fa-check"></i><b>4.5</b> Step One: Summarise the data</a></li>
<li class="chapter" data-level="4.6" data-path="difference.html"><a href="difference.html#step-two-plot-the-data"><i class="fa fa-check"></i><b>4.6</b> Step Two: Plot the data</a></li>
<li class="chapter" data-level="4.7" data-path="difference.html"><a href="difference.html#step-three-carry-out-statistical-analysis"><i class="fa fa-check"></i><b>4.7</b> Step Three: Carry out statistical analysis</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="difference.html"><a href="difference.html#are-the-data-normally-distributed"><i class="fa fa-check"></i><b>4.7.1</b> Are the data normally distributed?</a></li>
<li class="chapter" data-level="4.7.2" data-path="difference.html"><a href="difference.html#normality-test---analytical-method"><i class="fa fa-check"></i><b>4.7.2</b> Normality test - analytical method</a></li>
<li class="chapter" data-level="4.7.3" data-path="difference.html"><a href="difference.html#graphical-methods---the-quantile-quantile-or-qq-plot."><i class="fa fa-check"></i><b>4.7.3</b> Graphical methods - the quantile-quantile or QQ plot.</a></li>
<li class="chapter" data-level="4.7.4" data-path="difference.html"><a href="difference.html#the-thinking-about-the-data-normality-test"><i class="fa fa-check"></i><b>4.7.4</b> The ‘thinking about the data’ normality test</a></li>
<li class="chapter" data-level="4.7.5" data-path="difference.html"><a href="difference.html#now-for-the-actual-two-sample-t-test"><i class="fa fa-check"></i><b>4.7.5</b> Now for the actual two-sample <em>t</em>-test</a></li>
<li class="chapter" data-level="4.7.6" data-path="difference.html"><a href="difference.html#interpret-the-output-of-the-t-test."><i class="fa fa-check"></i><b>4.7.6</b> Interpret the output of the <em>t</em>-test.</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="difference.html"><a href="difference.html#the-complete-script"><i class="fa fa-check"></i><b>4.8</b> The complete script</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html"><i class="fa fa-check"></i><b>5</b> Paired tests for difference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#which-test-paired-t-test-or-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.1</b> Which test: paired t-test or Wilcoxon signed rank test?</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#the-paired-t-test"><i class="fa fa-check"></i><b>5.1.1</b> The paired t-test</a></li>
<li class="chapter" data-level="5.1.2" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#the-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.1.2</b> The Wilcoxon Signed Rank test</a></li>
<li class="chapter" data-level="5.1.3" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#null-hypotheses"><i class="fa fa-check"></i><b>5.1.3</b> Null Hypotheses</a></li>
<li class="chapter" data-level="5.1.4" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#test-output"><i class="fa fa-check"></i><b>5.1.4</b> Test output</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#example-2"><i class="fa fa-check"></i><b>5.2</b> Example</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#load-packages-2"><i class="fa fa-check"></i><b>5.2.1</b> Load packages</a></li>
<li class="chapter" data-level="5.2.2" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#load-data"><i class="fa fa-check"></i><b>5.2.2</b> Load data</a></li>
<li class="chapter" data-level="5.2.3" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#plot-the-data"><i class="fa fa-check"></i><b>5.2.3</b> Plot the data</a></li>
<li class="chapter" data-level="5.2.4" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#tidy-the-data"><i class="fa fa-check"></i><b>5.2.4</b> Tidy the data</a></li>
<li class="chapter" data-level="5.2.5" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#check-for-normality-of-differences"><i class="fa fa-check"></i><b>5.2.5</b> Check for normality of differences</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#the-non-parametric-alternative-the-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.3</b> The non-parametric alternative: The Wilcoxon signed rank test</a></li>
<li class="chapter" data-level="5.4" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#relation-to-one-sample-paired-test"><i class="fa fa-check"></i><b>5.4</b> Relation to one-sample paired test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova-two-way.html"><a href="anova-two-way.html"><i class="fa fa-check"></i><b>6</b> ANOVA: Two-way factorial experiments and model simplification</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova-two-way.html"><a href="anova-two-way.html#factorial-experiments-and-model-simplification"><i class="fa fa-check"></i><b>6.1</b> Factorial experiments and model simplification</a></li>
<li class="chapter" data-level="6.2" data-path="anova-two-way.html"><a href="anova-two-way.html#files-needed"><i class="fa fa-check"></i><b>6.2</b> Files needed</a></li>
<li class="chapter" data-level="6.3" data-path="anova-two-way.html"><a href="anova-two-way.html#open-your-project-1"><i class="fa fa-check"></i><b>6.3</b> Open your Project</a></li>
<li class="chapter" data-level="6.4" data-path="anova-two-way.html"><a href="anova-two-way.html#load-packages-3"><i class="fa fa-check"></i><b>6.4</b> Load packages</a></li>
<li class="chapter" data-level="6.5" data-path="anova-two-way.html"><a href="anova-two-way.html#read-in-the-data"><i class="fa fa-check"></i><b>6.5</b> Read in the data</a></li>
<li class="chapter" data-level="6.6" data-path="anova-two-way.html"><a href="anova-two-way.html#make-r-recognise-the-categorical-variables-as-factors-and-order-the-levels."><i class="fa fa-check"></i><b>6.6</b> Make R recognise the categorical variables as factors, and order the levels.</a></li>
<li class="chapter" data-level="6.7" data-path="anova-two-way.html"><a href="anova-two-way.html#summarise-the-data"><i class="fa fa-check"></i><b>6.7</b> Summarise the data</a></li>
<li class="chapter" data-level="6.8" data-path="anova-two-way.html"><a href="anova-two-way.html#plot-the-data-1"><i class="fa fa-check"></i><b>6.8</b> Plot the data</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="anova-two-way.html"><a href="anova-two-way.html#questions"><i class="fa fa-check"></i><b>6.8.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="anova-two-way.html"><a href="anova-two-way.html#anova"><i class="fa fa-check"></i><b>6.9</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="anova-two-way.html"><a href="anova-two-way.html#construct-the-model"><i class="fa fa-check"></i><b>6.9.1</b> Construct the model</a></li>
<li class="chapter" data-level="6.9.2" data-path="anova-two-way.html"><a href="anova-two-way.html#do-we-reject-the-null-hypothesis"><i class="fa fa-check"></i><b>6.9.2</b> Do we reject the null hypothesis?</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="anova-two-way.html"><a href="anova-two-way.html#model-simplification"><i class="fa fa-check"></i><b>6.10</b> Model Simplification</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="anova-two-way.html"><a href="anova-two-way.html#check-the-validity-of-the-linear-model"><i class="fa fa-check"></i><b>6.10.1</b> Check the validity of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="anova-two-way.html"><a href="anova-two-way.html#reporting-the-results"><i class="fa fa-check"></i><b>6.11</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova-one-way.html"><a href="anova-one-way.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="anova-one-way.html"><a href="anova-one-way.html#load-packages-4"><i class="fa fa-check"></i><b>7.1</b> Load packages</a></li>
<li class="chapter" data-level="7.2" data-path="anova-one-way.html"><a href="anova-one-way.html#remove-observations-with-missing-values"><i class="fa fa-check"></i><b>7.2</b> Remove observations with missing values</a></li>
<li class="chapter" data-level="7.3" data-path="anova-one-way.html"><a href="anova-one-way.html#summary---group-by-species-and-sex"><i class="fa fa-check"></i><b>7.3</b> Summary - group by species and sex</a></li>
<li class="chapter" data-level="7.4" data-path="anova-one-way.html"><a href="anova-one-way.html#plot-the-data-2"><i class="fa fa-check"></i><b>7.4</b> Plot the data</a></li>
<li class="chapter" data-level="7.5" data-path="anova-one-way.html"><a href="anova-one-way.html#one-way-anova"><i class="fa fa-check"></i><b>7.5</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="anova-one-way.html"><a href="anova-one-way.html#null-hypothesis"><i class="fa fa-check"></i><b>7.5.1</b> Null hypothesis</a></li>
<li class="chapter" data-level="7.5.2" data-path="anova-one-way.html"><a href="anova-one-way.html#the-actual-anova"><i class="fa fa-check"></i><b>7.5.2</b> The actual ANOVA</a></li>
<li class="chapter" data-level="7.5.3" data-path="anova-one-way.html"><a href="anova-one-way.html#construct-the-model-1"><i class="fa fa-check"></i><b>7.5.3</b> Construct the model</a></li>
<li class="chapter" data-level="7.5.4" data-path="anova-one-way.html"><a href="anova-one-way.html#is-the-model-valid"><i class="fa fa-check"></i><b>7.5.4</b> Is the model valid?</a></li>
<li class="chapter" data-level="7.5.5" data-path="anova-one-way.html"><a href="anova-one-way.html#the-overall-picture"><i class="fa fa-check"></i><b>7.5.5</b> The overall picture</a></li>
<li class="chapter" data-level="7.5.6" data-path="anova-one-way.html"><a href="anova-one-way.html#the-detailed-picture"><i class="fa fa-check"></i><b>7.5.6</b> The detailed picture</a></li>
<li class="chapter" data-level="7.5.7" data-path="anova-one-way.html"><a href="anova-one-way.html#post-hoc-tsts."><i class="fa fa-check"></i><b>7.5.7</b> Post hoc tsts.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="anova-one-way.html"><a href="anova-one-way.html#reporting-the-result."><i class="fa fa-check"></i><b>7.6</b> Reporting the Result.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>8</b> Correlation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlation.html"><a href="correlation.html#the-correlation-coefficient"><i class="fa fa-check"></i><b>8.1</b> The correlation coefficient</a></li>
<li class="chapter" data-level="8.2" data-path="correlation.html"><a href="correlation.html#different-values-of-r."><i class="fa fa-check"></i><b>8.2</b> Different values of <em>r</em>.</a></li>
<li class="chapter" data-level="8.3" data-path="correlation.html"><a href="correlation.html#using-r-to-find-the-correlation-coefficient."><i class="fa fa-check"></i><b>8.3</b> Using R to find the correlation coefficient.</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="correlation.html"><a href="correlation.html#correlations-for-real-data"><i class="fa fa-check"></i><b>8.3.1</b> Correlations for real data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="correlation.html"><a href="correlation.html#the-correlation-coefficient-measures-the-degree-of-linear-association."><i class="fa fa-check"></i><b>8.4</b> The correlation coefficient measures the degree of linear association.</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="correlation.html"><a href="correlation.html#when-is-it-appropriate-to-calculate-a-correlation-coefficient"><i class="fa fa-check"></i><b>8.4.1</b> When is it appropriate to calculate a correlation coefficient?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="correlation.html"><a href="correlation.html#association-is-not-causation"><i class="fa fa-check"></i><b>8.5</b> Association is not causation</a></li>
<li class="chapter" data-level="8.6" data-path="correlation.html"><a href="correlation.html#examples"><i class="fa fa-check"></i><b>8.6</b> Examples</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="correlation.html"><a href="correlation.html#lichen-abundance"><i class="fa fa-check"></i><b>8.6.1</b> Lichen abundance</a></li>
<li class="chapter" data-level="8.6.2" data-path="correlation.html"><a href="correlation.html#soil-bacteria"><i class="fa fa-check"></i><b>8.6.2</b> Soil bacteria</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="correlation.html"><a href="correlation.html#exercises"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="correlation.html"><a href="correlation.html#exercise-1"><i class="fa fa-check"></i><b>8.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="8.7.2" data-path="correlation.html"><a href="correlation.html#exercise-2"><i class="fa fa-check"></i><b>8.7.2</b> Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html"><i class="fa fa-check"></i><b>9</b> Simple linear regression {#linear regression}</a>
<ul>
<li class="chapter" data-level="9.1" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="9.2" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#load-packages-5"><i class="fa fa-check"></i><b>9.2</b> Load packages</a></li>
<li class="chapter" data-level="9.3" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#get-the-data"><i class="fa fa-check"></i><b>9.3</b> Get the data</a></li>
<li class="chapter" data-level="9.4" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#plot-the-data-3"><i class="fa fa-check"></i><b>9.4</b> Plot the data</a></li>
<li class="chapter" data-level="9.5" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#make-a-simple-model-using-linear-regression"><i class="fa fa-check"></i><b>9.5</b> Make a simple model using linear regression</a></li>
<li class="chapter" data-level="9.6" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#check-assumptions"><i class="fa fa-check"></i><b>9.6</b> Check assumptions</a></li>
<li class="chapter" data-level="9.7" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#interpretation-of-the-model"><i class="fa fa-check"></i><b>9.7</b> Interpretation of the model</a></li>
<li class="chapter" data-level="9.8" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#back-to-the-figure"><i class="fa fa-check"></i><b>9.8</b> Back to the figure</a></li>
<li class="chapter" data-level="9.9" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#conclusion-1"><i class="fa fa-check"></i><b>9.9</b> Conclusion</a></li>
<li class="chapter" data-level="9.10" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#sample-script"><i class="fa fa-check"></i><b>9.10</b> Sample script</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html"><i class="fa fa-check"></i><b>A</b> A primer in statistics</a>
<ul>
<li class="chapter" data-level="A.1" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#populations-and-samples"><i class="fa fa-check"></i><b>A.1</b> Populations and samples</a></li>
<li class="chapter" data-level="A.2" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#three-types-of-variability-of-the-sample-of-the-population-and-of-the-estimate."><i class="fa fa-check"></i><b>A.2</b> Three types of variability: of the sample, of the population and of the estimate.</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#variability-of-the-sample"><i class="fa fa-check"></i><b>A.2.1</b> Variability of the sample</a></li>
<li class="chapter" data-level="A.2.2" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#variability-of-the-population"><i class="fa fa-check"></i><b>A.2.2</b> Variability of the population</a></li>
<li class="chapter" data-level="A.2.3" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#variability-of-the-estimate"><i class="fa fa-check"></i><b>A.2.3</b> Variability of the estimate</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#confidence-intervals-a-way-of-precisely-representing-uncertainty"><i class="fa fa-check"></i><b>A.3</b> Confidence intervals: a way of precisely representing uncertainty</a></li>
<li class="chapter" data-level="A.4" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>A.4</b> The <span class="math inline">\(t\)</span>-distribution</a></li>
<li class="chapter" data-level="A.5" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#hypothesis-testing"><i class="fa fa-check"></i><b>A.5</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#general-procedure-for-a-hypothesis-test"><i class="fa fa-check"></i><b>A.5.1</b> General procedure for a hypothesis test</a></li>
<li class="chapter" data-level="A.5.2" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#comparing-one-mean-with-a-threshold---one-sample-t-test"><i class="fa fa-check"></i><b>A.5.2</b> Comparing one mean with a threshold - one sample <em>t</em>-test</a></li>
<li class="chapter" data-level="A.5.3" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#comparing-two-means---two-sample-test"><i class="fa fa-check"></i><b>A.5.3</b> Comparing two means - two-sample test</a></li>
<li class="chapter" data-level="A.5.4" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#alternatives-to-the-t-test"><i class="fa fa-check"></i><b>A.5.4</b> Alternatives to the <em>t</em>-test</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#size-effects-vs-hypothesis-testing."><i class="fa fa-check"></i><b>A.6</b> Size effects vs hypothesis testing.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis for Newquay University Centre</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fishers-exact-test" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Fisher’s exact test<a href="fishers-exact-test.html#fishers-exact-test" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="fishers-exact-test.html#cb64-1" tabindex="-1"></a>theme_no_axes<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb64-2"><a href="fishers-exact-test.html#cb64-2" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.line=</span><span class="fu">element_blank</span>(),</span>
<span id="cb64-3"><a href="fishers-exact-test.html#cb64-3" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb64-4"><a href="fishers-exact-test.html#cb64-4" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),</span>
<span id="cb64-5"><a href="fishers-exact-test.html#cb64-5" tabindex="-1"></a>        <span class="at">axis.ticks=</span><span class="fu">element_blank</span>(),</span>
<span id="cb64-6"><a href="fishers-exact-test.html#cb64-6" tabindex="-1"></a>        <span class="at">axis.title.x=</span><span class="fu">element_blank</span>(),</span>
<span id="cb64-7"><a href="fishers-exact-test.html#cb64-7" tabindex="-1"></a>        <span class="at">axis.title.y=</span><span class="fu">element_blank</span>())</span>
<span id="cb64-8"><a href="fishers-exact-test.html#cb64-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="fishers-exact-test.html#cb65-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-2"><a href="fishers-exact-test.html#cb65-2" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb65-3"><a href="fishers-exact-test.html#cb65-3" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb65-4"><a href="fishers-exact-test.html#cb65-4" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb65-5"><a href="fishers-exact-test.html#cb65-5" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb65-6"><a href="fishers-exact-test.html#cb65-6" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb65-7"><a href="fishers-exact-test.html#cb65-7" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb65-8"><a href="fishers-exact-test.html#cb65-8" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_cowplot</span>()<span class="sc">+</span><span class="fu">theme_no_axes</span>())</span></code></pre></div>
<p>Fisher’s Exact Test can be used in place of a chi-square test for independence in cases where counts are too low to make the chi-square approximation appropriate for calculating a <em>p</em>-value. A rule of thumb often used for this is that a chi-square test is no longer reliable when there are fewer than five or so counts in every cell of the contingency table.</p>
<p>Ronald Fisher devised an exact test now named after him that could be used for this scenario in situations where the marginal totals (ie row totals and column totals) of the table were fixed by the experimenter.</p>
<p>Say we were devising a phone app that we hoped could distingush between two visually similar species of grass given a photo. In an experiment, we show the app 10 cases of species A and 10 of species B and in each case we record the identification decision of the app. That will give four possibilities.</p>
<ul>
<li>species is A, app identifies it as A</li>
<li>species is A, app identifies it as B</li>
<li>species is B, app identifies is as B</li>
<li>species is B, app identifies it as A</li>
</ul>
<p>The counts of these decisions can be recorded in a two-way, in this case <span class="math inline">\(2 \times 2\)</span>, table, in which each cell contains the counts recorded for each combination of the levels of each factor. In a test run, suppose the numbers recorded for each case were as follows:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="fishers-exact-test.html#cb66-1" tabindex="-1"></a><span class="co"># Results plot</span></span>
<span id="cb66-2"><a href="fishers-exact-test.html#cb66-2" tabindex="-1"></a></span>
<span id="cb66-3"><a href="fishers-exact-test.html#cb66-3" tabindex="-1"></a>fet_table<span class="ot">&lt;-</span><span class="cf">function</span>(resultr1c1,nn,row1,col1,r1c1,<span class="at">minimal=</span><span class="cn">FALSE</span>,<span class="at">arrow=</span><span class="cn">FALSE</span>){</span>
<span id="cb66-4"><a href="fishers-exact-test.html#cb66-4" tabindex="-1"></a></span>
<span id="cb66-5"><a href="fishers-exact-test.html#cb66-5" tabindex="-1"></a>  row2<span class="ot">=</span>nn<span class="sc">-</span>row1</span>
<span id="cb66-6"><a href="fishers-exact-test.html#cb66-6" tabindex="-1"></a>  col2<span class="ot">=</span>nn<span class="sc">-</span>col1</span>
<span id="cb66-7"><a href="fishers-exact-test.html#cb66-7" tabindex="-1"></a>  r1c2<span class="ot">=</span>row1<span class="sc">-</span>r1c1</span>
<span id="cb66-8"><a href="fishers-exact-test.html#cb66-8" tabindex="-1"></a>  r2c1<span class="ot">=</span>col1<span class="sc">-</span>r1c1</span>
<span id="cb66-9"><a href="fishers-exact-test.html#cb66-9" tabindex="-1"></a>  r2c2<span class="ot">=</span>nn<span class="sc">-</span>row1<span class="sc">-</span>col1<span class="sc">+</span>r1c1</span>
<span id="cb66-10"><a href="fishers-exact-test.html#cb66-10" tabindex="-1"></a>  </span>
<span id="cb66-11"><a href="fishers-exact-test.html#cb66-11" tabindex="-1"></a>  numbers_size<span class="ot">&lt;-</span><span class="fu">ifelse</span>(minimal,<span class="dv">5</span>,<span class="dv">7</span>)</span>
<span id="cb66-12"><a href="fishers-exact-test.html#cb66-12" tabindex="-1"></a></span>
<span id="cb66-13"><a href="fishers-exact-test.html#cb66-13" tabindex="-1"></a>ct<span class="ot">&lt;-</span><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb66-14"><a href="fishers-exact-test.html#cb66-14" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="fl">0.8</span>, <span class="at">xmax =</span> <span class="fl">5.2</span>, <span class="at">ymin =</span> <span class="fl">0.9</span>, <span class="at">ymax =</span> <span class="fl">3.1</span>),<span class="at">colour=</span><span class="st">&quot;grey50&quot;</span>,</span>
<span id="cb66-15"><a href="fishers-exact-test.html#cb66-15" tabindex="-1"></a>            <span class="at">fill=</span><span class="fu">ifelse</span>(r1c1<span class="sc">==</span>resultr1c1,<span class="st">&quot;grey80&quot;</span>,<span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb66-16"><a href="fishers-exact-test.html#cb66-16" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fu">ifelse</span>(minimal,<span class="fl">0.3</span>,<span class="sc">-</span><span class="dv">3</span>),<span class="fu">ifelse</span>(minimal,<span class="dv">9</span>,<span class="dv">9</span>))) <span class="sc">+</span></span>
<span id="cb66-17"><a href="fishers-exact-test.html#cb66-17" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="fu">ifelse</span>(minimal,<span class="fl">0.5</span>,<span class="dv">0</span>),<span class="fu">ifelse</span>(minimal,<span class="fl">3.5</span>,<span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb66-18"><a href="fishers-exact-test.html#cb66-18" tabindex="-1"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb66-19"><a href="fishers-exact-test.html#cb66-19" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">1.5</span>,<span class="fl">1.5</span>),<span class="at">label=</span><span class="fu">c</span>(r1c1,r1c2,r2c1,r2c2),</span>
<span id="cb66-20"><a href="fishers-exact-test.html#cb66-20" tabindex="-1"></a>           <span class="at">size=</span>numbers_size,</span>
<span id="cb66-21"><a href="fishers-exact-test.html#cb66-21" tabindex="-1"></a>           <span class="at">colour=</span><span class="fu">ifelse</span>(r1c1<span class="sc">==</span>resultr1c1,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;black&quot;</span>))</span>
<span id="cb66-22"><a href="fishers-exact-test.html#cb66-22" tabindex="-1"></a></span>
<span id="cb66-23"><a href="fishers-exact-test.html#cb66-23" tabindex="-1"></a></span>
<span id="cb66-24"><a href="fishers-exact-test.html#cb66-24" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span>minimal){</span>
<span id="cb66-25"><a href="fishers-exact-test.html#cb66-25" tabindex="-1"></a>  ct <span class="ot">&lt;-</span> ct <span class="sc">+</span></span>
<span id="cb66-26"><a href="fishers-exact-test.html#cb66-26" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fu">c</span>(<span class="fl">5.8</span>,<span class="fl">5.8</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">1.5</span>),<span class="at">label=</span><span class="fu">c</span>(row1,row2),<span class="at">size=</span>numbers_size) <span class="sc">+</span> <span class="co">#row totals</span></span>
<span id="cb66-27"><a href="fishers-exact-test.html#cb66-27" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fu">c</span>(<span class="fl">2.0</span>,<span class="fl">4.0</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>),<span class="at">label=</span><span class="fu">c</span>(col1,col2),<span class="at">size=</span>numbers_size) <span class="sc">+</span> <span class="co">#column totals</span></span>
<span id="cb66-28"><a href="fishers-exact-test.html#cb66-28" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fl">5.8</span>,<span class="at">y=</span><span class="fl">0.5</span>,<span class="at">label=</span>nn,<span class="at">size=</span>numbers_size) <span class="sc">+</span> <span class="co"># grand total</span></span>
<span id="cb66-29"><a href="fishers-exact-test.html#cb66-29" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.0</span>,<span class="sc">-</span><span class="fl">0.0</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">2.5</span>),<span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;Sp. B&quot;</span>,<span class="st">&quot;Sp. A&quot;</span>),<span class="at">size=</span>numbers_size) <span class="sc">+</span> <span class="co"># row labels</span></span>
<span id="cb66-30"><a href="fishers-exact-test.html#cb66-30" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>),<span class="at">y=</span><span class="fu">c</span>(<span class="fl">3.5</span>,<span class="fl">3.5</span>),<span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;Sp. A&quot;</span>,<span class="st">&quot;Sp. B&quot;</span>),<span class="at">size=</span>numbers_size) <span class="sc">+</span> <span class="co"># column labels</span></span>
<span id="cb66-31"><a href="fishers-exact-test.html#cb66-31" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="dv">3</span>,<span class="at">y=</span><span class="fl">4.2</span>,<span class="at">label=</span><span class="st">&quot;App Decision&quot;</span>,<span class="at">colour=</span><span class="st">&quot;darkred&quot;</span>,<span class="at">size=</span>numbers_size) <span class="sc">+</span> <span class="co"># column title</span></span>
<span id="cb66-32"><a href="fishers-exact-test.html#cb66-32" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="sc">-</span><span class="fl">1.1</span>,<span class="at">y=</span><span class="dv">2</span>,<span class="at">label=</span><span class="st">&quot;Truth&quot;</span>,<span class="at">angle=</span><span class="dv">90</span>,<span class="at">colour=</span><span class="st">&quot;darkred&quot;</span>,<span class="at">size=</span>numbers_size)  <span class="co"># row title</span></span>
<span id="cb66-33"><a href="fishers-exact-test.html#cb66-33" tabindex="-1"></a>}</span>
<span id="cb66-34"><a href="fishers-exact-test.html#cb66-34" tabindex="-1"></a></span>
<span id="cb66-35"><a href="fishers-exact-test.html#cb66-35" tabindex="-1"></a><span class="co">#pval&lt;-fisher.test(matrix(c(r1c1,r2c1,r1c2,r2c2),nrow=2))$p.value</span></span>
<span id="cb66-36"><a href="fishers-exact-test.html#cb66-36" tabindex="-1"></a></span>
<span id="cb66-37"><a href="fishers-exact-test.html#cb66-37" tabindex="-1"></a>pval<span class="ot">&lt;-</span><span class="fu">dhyper</span>(r1c1, col1, nn<span class="sc">-</span>col1, row1)</span>
<span id="cb66-38"><a href="fishers-exact-test.html#cb66-38" tabindex="-1"></a></span>
<span id="cb66-39"><a href="fishers-exact-test.html#cb66-39" tabindex="-1"></a><span class="cf">if</span>(arrow){</span>
<span id="cb66-40"><a href="fishers-exact-test.html#cb66-40" tabindex="-1"></a>  ct <span class="ot">&lt;-</span> ct <span class="sc">+</span></span>
<span id="cb66-41"><a href="fishers-exact-test.html#cb66-41" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">5.4</span>,<span class="at">xend=</span><span class="fl">6.5</span>,<span class="at">y=</span><span class="dv">2</span>,<span class="at">yend=</span><span class="dv">2</span>),<span class="at">arrow=</span><span class="fu">arrow</span>(<span class="at">length=</span><span class="fu">unit</span>(<span class="dv">2</span>,<span class="st">&quot;mm&quot;</span>),<span class="at">type=</span><span class="st">&quot;closed&quot;</span>)) <span class="sc">+</span></span>
<span id="cb66-42"><a href="fishers-exact-test.html#cb66-42" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fl">6.7</span>,<span class="at">y=</span><span class="dv">2</span>,<span class="at">label=</span><span class="st">&quot;italic(p)&quot;</span>,<span class="at">size=</span><span class="fl">3.5</span>,<span class="at">hjust=</span><span class="dv">0</span>,<span class="at">parse=</span><span class="cn">TRUE</span>)  <span class="sc">+</span> <span class="co"># p value</span></span>
<span id="cb66-43"><a href="fishers-exact-test.html#cb66-43" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fl">7.0</span>,<span class="at">y=</span><span class="dv">2</span>,<span class="at">label=</span><span class="fu">paste</span>(<span class="st">&quot; = &quot;</span>,<span class="fu">round</span>(pval,<span class="dv">5</span>)),<span class="at">size=</span><span class="fl">3.5</span>,<span class="at">hjust=</span><span class="dv">0</span>)  <span class="co"># p value</span></span>
<span id="cb66-44"><a href="fishers-exact-test.html#cb66-44" tabindex="-1"></a>}</span>
<span id="cb66-45"><a href="fishers-exact-test.html#cb66-45" tabindex="-1"></a></span>
<span id="cb66-46"><a href="fishers-exact-test.html#cb66-46" tabindex="-1"></a>  </span>
<span id="cb66-47"><a href="fishers-exact-test.html#cb66-47" tabindex="-1"></a><span class="fu">list</span>(ct,pval)</span>
<span id="cb66-48"><a href="fishers-exact-test.html#cb66-48" tabindex="-1"></a></span>
<span id="cb66-49"><a href="fishers-exact-test.html#cb66-49" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="fishers-exact-test.html#cb67-1" tabindex="-1"></a>resultr1c1<span class="ot">=</span><span class="dv">3</span></span>
<span id="cb67-2"><a href="fishers-exact-test.html#cb67-2" tabindex="-1"></a>results_obtained_plot<span class="ot">&lt;-</span><span class="fu">fet_table</span>(<span class="at">resultr1c1=</span>resultr1c1,<span class="at">nn=</span><span class="dv">20</span>,<span class="at">row1=</span><span class="dv">10</span>,<span class="at">col1=</span><span class="dv">11</span>,<span class="at">r1c1=</span>resultr1c1,<span class="at">minimal=</span><span class="cn">FALSE</span>,<span class="at">arrow=</span><span class="cn">FALSE</span>)</span>
<span id="cb67-3"><a href="fishers-exact-test.html#cb67-3" tabindex="-1"></a>results_obtained_plot[[<span class="dv">1</span>]]</span></code></pre></div>
<p><img src="fishers_exact_test_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Here we see that the row totals are set by the experimenter while the column totals are set by the app. Thus we see that the app is slightly more likely to choose A than B, regardless of the actual identity of the plant, since it went for A 11 times out of 20, and for B only 9 times.</p>
<p>Our <strong>null hypothesis</strong> might be:</p>
<p>The app has no ability to correctly distinguish species A from species B.</p>
<p>We should not use a chi-square test for independence here since the numbers in two of the cells are less than 5.</p>
<p>In the Fisher’s Exact Test, we accept that the marginal totals are as observed. With this constraint we then determine the probability of getting every possible table of cells, under the null hypothesis that the two factors are independent of each other. The <em>p</em>-value for (lack of) independence of the two variables is then the cumulative sum of the probabilities of getting the table we actually got, plus those of tables that are even less likely. That is just what <em>p</em>-values are - the probabiliy of gettting the data you got, or more extreme data, <em>if</em> the null hypothesis is true.</p>
<p>To do this, we notice that if the column and row totals have been fixed in advance, then only one of the cell values of the table is independent. We can choose any cell. Once this is known, all the others can be determined, using this first value and the marginal totals. It turns that we can treat this number as a random variable that varies with probabilities governed by the <strong>hypergeometric</strong> distribution. We can thus use this distribution to calculate the probability of getting any possible table, given the row and column totals.</p>
<p>Let’s see how this works.</p>
<div id="the-hypergeometric-function" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> The Hypergeometric Function<a href="fishers-exact-test.html#the-hypergeometric-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Imagine an urn with <em>N</em> balls, <em>K</em> of them white, the rest, <em>N</em>-<em>K</em> of them, black.</p>
<p>Draw a sample of <em>n</em> balls <em>without</em> replacement - that is, don’t put a ball back in the urn once it has been taken out.</p>
<p>Let <em>x</em> be the number of white balls in the sample.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="fishers-exact-test.html#cb68-1" tabindex="-1"></a><span class="co"># Symbols plot</span></span>
<span id="cb68-2"><a href="fishers-exact-test.html#cb68-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb68-3"><a href="fishers-exact-test.html#cb68-3" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="fl">0.8</span>, <span class="at">xmax =</span> <span class="fl">5.2</span>, <span class="at">ymin =</span> <span class="fl">0.9</span>, <span class="at">ymax =</span> <span class="fl">3.1</span>),<span class="at">colour=</span><span class="st">&quot;grey50&quot;</span>,<span class="at">fill=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb68-4"><a href="fishers-exact-test.html#cb68-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb68-5"><a href="fishers-exact-test.html#cb68-5" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb68-6"><a href="fishers-exact-test.html#cb68-6" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.7</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">5.8</span>,<span class="fl">5.8</span>,<span class="fl">5.8</span>,<span class="dv">3</span>),</span>
<span id="cb68-7"><a href="fishers-exact-test.html#cb68-7" tabindex="-1"></a>           <span class="at">y=</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">3.5</span>,<span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="fl">4.2</span>),</span>
<span id="cb68-8"><a href="fishers-exact-test.html#cb68-8" tabindex="-1"></a>           <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;not sampled&quot;</span>,<span class="st">&quot;sampled&quot;</span>,<span class="st">&quot;K&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;N-K&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N-n&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;In urn&quot;</span>),</span>
<span id="cb68-9"><a href="fishers-exact-test.html#cb68-9" tabindex="-1"></a>           <span class="at">size=</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb68-10"><a href="fishers-exact-test.html#cb68-10" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="fishers_exact_test_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>x</em> is a random variable that follows a <em>hypergeometric</em> (<em>N</em>, <em>K</em>, <em>n</em>) distribution:</p>
<p><span class="math display">\[
\text{P}(X=x)=\frac{{K \choose x} {{N-K} \choose {N-x}}}{N\choose n}
\]</span></p>
<p>Here, terms like <span class="math inline">\(K\choose x\)</span> refer to the number of ways that <em>n</em> objects can be chosen from a collection of <em>N</em> objects. For details, see any book on proability, but the deatils need not concern us here. This tells us the probability that we will get <em>x</em> white balls if we draw <em>n</em> balls without replacement (each ball that is drawn is not put back) from an urn that at first contains <em>N</em> balls, <em>K</em> of them white.</p>
<p>For example, if we have an urn with <em>N</em> = 20 balls, <em>K</em> = 11 of them white, the remaining <em>N</em> - <em>K</em> = 9 of them black, and draw <em>n</em> = 10 balls without replacement, the probability that <em>x</em> = 7 of these will be white is given by</p>
<p><span class="math display">\[
\begin{align*}
N=20, K&amp;=11, n=10, x=7\\
\\
\text{P}(X=7)&amp; =\frac{{K \choose x} {{N-K} \choose {N-x}}}{N\choose n}\\
&amp;=\frac{{11 \choose 7} {{20-11} \choose {20-7}}}{20\choose 10}\\
&amp;= 0.014
\end{align*}
\]</span>
Here, we calculated the probability of getting <span class="math inline">\(x\)</span> <em>given</em> the number <span class="math inline">\(K\)</span> of white balls in the urn, which is one column total of the table, the number <span class="math inline">\(n\)</span> of balls that were sampled, which is one row total, and the total number <span class="math inline">\(N\)</span> of balls in the urn. Given these three numbers we know the other column total, which must be <span class="math inline">\(N-K\)</span>, and the other row total which must be <span class="math inline">\(N-n\)</span>. These are the numbers of balls that were not sampled and the number of black balls in the urn, respectively.</p>
<p>Further, given that these row and column totals are all known, if we get <span class="math inline">\(x\)</span> white balls among the <span class="math inline">\(n\)</span> balls that we take from the urn, we also know the other three values in the table. That is we know the number of black balls that came out, and the numbers of white and black balls that must still be in the urn.</p>
<p>In other words, when we calculate the probability of getting a particular number <span class="math inline">\(x\)</span> of white balls from the urn, out of <span class="math inline">\(n\)</span> that we drew altogether, given that the urn contains <span class="math inline">\(K\)</span> white balls and <span class="math inline">\(N\)</span> balls altogether, we are calculating the probability of getting a particular set of four values in the <span class="math inline">\(2 \times 2\)</span> table.</p>
<p>Note too that when balls are sampled from the urn we do not preferentially sample white or black balls: we would expect the ratio of colours sampled to be roughly equal to the ratio of colours actually in the urn.</p>
<p>This is precisely the scenario for our app data under the null hypothesis of no association between the truth and the app’s decision. We know how many times it decided on Species A (ie we know one column total of our table, let’s call it <span class="math inline">\(K = 11\)</span>), we know how many seedlings of species A we actually had (so that’s one row total, let’s call it <span class="math inline">\(n = 10\)</span>) and we know how many seedlings we had altogether: <span class="math inline">\(N = 20\)</span>. Therefore, just as with the urn, we also know the other row and column totals, which must be 10 and 9 respectively. We find that the app decided on species A just 3 times. Convince yourself that knowing all these numbers means that the other entries in the table (top right, and the bottom row) are now also known.</p>
<p>Thus if we want to calculate the probability of getting precisely this table, that will be the same as the probability of deciding there were 3 white seedlings since that number fixes the other three entries in the table.</p>
<p>And finally, and more precisely, if we want to calculate the probability of our app getting this table of results <em>given</em> that its decision for any seedling is independenty of the truth for that seedling, then we have exactly the same set-up asfor the urn, and we can use the hypergeometric function to calculate the probability of getting any particular table of results.</p>
<p>In case you are worried, <em>we</em> will not normally use the hypergeometric function directly, nor de we even need to know it is being used. We can use the R runction <code>fisher.test()</code>: see below.</p>
</div>
<div id="hypergeometric-distribution-in-r" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Hypergeometric Distribution in R<a href="fishers-exact-test.html#hypergeometric-distribution-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>However if you are interested in the hypergeometric function, it is catered for in R like many other distributions by a family of four functions:</p>
<ul>
<li><code>dhyper(x, m, n, k)</code>.</li>
<li><code>phyper(q, m, n, k)</code>.</li>
<li><code>qhyper(p, m, n, k)</code>.</li>
<li><code>rhyper(nn, m, n, k)</code>.</li>
</ul>
<p>where, in R:</p>
<ul>
<li>m = number of white balls in urn<br />
</li>
<li>n = number of black balls in urn.</li>
<li>k = number of balls sampled (without replacement).</li>
<li>x = number of white balls in sample.</li>
<li>nn= number of balls in urn = m + n</li>
</ul>
<p>For further information on the use of any of these, type the name of the function preceded by a question mark into the console pane, bottom left. Help will then appear in the Help pane, bottom right.</p>
<p>In our example, to calculate the probability of a given table of results,</p>
<p>dhyper(r1c1, col1, nn-col1, row1)</p>
</div>
<div id="back-to-fishers-exact-test" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Back to Fisher’s Exact Test<a href="fishers-exact-test.html#back-to-fishers-exact-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First we will go through all the steps manually just so you can see what is going on under the hood of a Fisher’s Exact Test, then we will do the test in R.</p>
<p>In this test we</p>
<ul>
<li>Assume the null hypothesis (independence) to be true.</li>
<li>Constrain the marginal counts to be as observed<br />
</li>
<li>Calculate the probability of the observed table, given the null hypothesis</li>
</ul>
<p>In the case of the example, that means that we should calculate</p>
<p><span class="math display">\[
P(\text{observed table}|H_0) = P(X=7|H_0)\\
X ∼ \text{Hypergeometric} (N=20, K=11, n=10)
\]</span>
and then</p>
<ul>
<li>In the same way we calculate the probabilities of all possible tables, given the constraints of the marginal totals, then we</li>
<li>Sum the probabilities of all tables that are as or more ‘extreme’ than the observed table ie whose probability is less than or equal to that of the observed table.</li>
<li>The resulting sum is the <em>p</em>-value of the observed table, given the marginal totals.<br />
</li>
<li>If this <em>p</em>-value is less than a predetermined threshold value (the value chosen is usually 0.05) then we reject the null hypothesis and regard the data as providing evidence for an association between the factors. That is we reject the idea that they are independent of each other. In the case presented above, that means we reject the idea</li>
</ul>
</div>
<div id="example-1" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Example<a href="fishers-exact-test.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the figure below we show all possible tables, along with their respective <em>p</em>-values, calculate using the hypergeometric function. The table of the actual results obtained is picked out in colour. We see that tables</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="fishers-exact-test.html#cb69-1" tabindex="-1"></a>resultr1c1<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb69-2"><a href="fishers-exact-test.html#cb69-2" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">10</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-3"><a href="fishers-exact-test.html#cb69-3" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">9</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-4"><a href="fishers-exact-test.html#cb69-4" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">8</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-5"><a href="fishers-exact-test.html#cb69-5" tabindex="-1"></a>p4<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">7</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-6"><a href="fishers-exact-test.html#cb69-6" tabindex="-1"></a>p5<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">6</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-7"><a href="fishers-exact-test.html#cb69-7" tabindex="-1"></a>p6<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">5</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-8"><a href="fishers-exact-test.html#cb69-8" tabindex="-1"></a>p7<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">4</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-9"><a href="fishers-exact-test.html#cb69-9" tabindex="-1"></a>p8<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">3</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-10"><a href="fishers-exact-test.html#cb69-10" tabindex="-1"></a>p9<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">2</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span>
<span id="cb69-11"><a href="fishers-exact-test.html#cb69-11" tabindex="-1"></a>p10<span class="ot">&lt;-</span><span class="fu">fet_table</span>(resultr1c1,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">1</span>,<span class="at">minimal=</span><span class="cn">TRUE</span>,<span class="at">arrow=</span><span class="cn">TRUE</span>)[[<span class="dv">1</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="fishers-exact-test.html#cb70-1" tabindex="-1"></a><span class="fu">plot_grid</span>(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">scale=</span><span class="fl">1.5</span>,<span class="at">greedy=</span><span class="cn">TRUE</span>,<span class="at">byrow=</span><span class="cn">FALSE</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;f&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;g&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;h&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;i&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;j&quot;</span>))</span></code></pre></div>
<p><img src="fishers_exact_test_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We see that tables a), b), c), h) (the actual results), i) and j) all have <em>p</em>-values equal to or less than that of the actual results. The combined total of these <em>p</em>-values is 0.06978.</p>
<p>This <em>p</em>-value is bigger than 0.05 so we would normally fail to reject the null hypothesis that there is no association between the two factors. There is no evidence from these data that the app does any better than guessing whether a plant is species A or species B!</p>
</div>
<div id="fishers-exact-test-in-r" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Fisher’s Exact Test in R<a href="fishers-exact-test.html#fishers-exact-test-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we already know the four counts for our <span class="math inline">\(2 \times 2\)</span> table we can create a <span class="math inline">\(2 \times 2\)</span> matrix of them like this:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="fishers-exact-test.html#cb71-1" tabindex="-1"></a>app.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb71-2"><a href="fishers-exact-test.html#cb71-2" tabindex="-1"></a>app.mat</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    3    7
## [2,]    8    2</code></pre>
<p>If we had the data in a tidy data frame like we had for the ladybird data we can convert it into a matrix using the <code>xtabs()</code> command in the same way as we did there.</p>
<p>We use this matrix as the argument of the <code>fisher.test()</code> function:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="fishers-exact-test.html#cb73-1" tabindex="-1"></a><span class="fu">fisher.test</span>(app.mat)</span></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  app.mat
## p-value = 0.06978
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.007870555 1.133635839
## sample estimates:
## odds ratio 
##  0.1226533</code></pre>
<p>That’s it! It’s a one liner, just like many statistical tests in R. You will see that this gives the same <em>p</em>-value that we have calculated manually.</p>
</div>
<div id="what-if-we-just-use-a-chi-square-test" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> What if we just use a chi-square test?<a href="fishers-exact-test.html#what-if-we-just-use-a-chi-square-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If we use a chi-square test on this same data, R gives us a warning, because of the low values in the table:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="fishers-exact-test.html#cb75-1" tabindex="-1"></a><span class="fu">chisq.test</span>(app.mat)</span></code></pre></div>
<pre><code>## Warning in stats::chisq.test(x, y, ...): Chi-squared approximation may be
## incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  app.mat
## X-squared = 3.2323, df = 1, p-value = 0.0722</code></pre>
<p>This is a cautionary tale: you can use R to run this or that test on data even when the data are unsuitable for the test, and you will get an output, but the output may not be reliable. Here, at least, we are given a warning that alerts us to this possibility, and in fact our conclusion would be the same as it was when using the Fisher’s Exact Test, but that is not always the case. You need to think carefully as to whether a given test is the right one <em>before</em> you use it.</p>
</div>
<div id="why-not-always-use-fishers-exact-test-instead-of-a-chi-square-test" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Why not always use Fisher’s Exact Test instead of a chi-square test?<a href="fishers-exact-test.html#why-not-always-use-fishers-exact-test-instead-of-a-chi-square-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fisher’s Exact Test becomes computationally expensive when the number of tables for which a <em>p</em>-value has to be calculated becomes very large. This happens very quickly when each of the two factors has more than two levels, so that the contingency table is no longer <span class="math inline">\(2 \times 2\)</span> but <span class="math inline">\(3 \times 4\)</span> or <span class="math inline">\(4\times 6\)</span> and so on. However for <span class="math inline">\(2 \times 2\)</span> tables it works well and quickly for table cell values into the 1000s and is a perfectly valid alternative to the chi-squared test. But then, in that case, why not just use a chi-squared test? For large cell values this works well and anyone reading your work is more likely to be familiar with it than with the Fisher’s Exact Test.</p>
</div>
<div id="another-cautionary-note" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Another Cautionary Note<a href="fishers-exact-test.html#another-cautionary-note" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This leads us to think that the Fisher’s Exact Test is only really a better alternative to the chi-squared test when sample sizes are very small and the chi-squared approximation becomes invalid. However, think about it. If you have a small sample then it is likely that it is not very representative of the population from which it has been drawn, and that you will fail to detect any association that there may be between the two factors. The solution therefore, when you have a small sample, is likely not to say Hallelujah! and grasp the Fisher’s Test with glee, but, if you can, to get a bigger sample. However, if that is not possible and you are stuck with a small sample size, then a Fisher’s Exact Test of independence is more reliable than a chi-squared test.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chi-square.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="difference.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Newquay-University-Centre/r4nqy/edit/main/fishers_exact_test.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/Newquay-University-Centre/r4nqy/raw/main/fishers_exact_test.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
