<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Paired tests for difference | Data analysis for Newquay University Centre</title>
  <meta name="description" content="A work in progress" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Paired tests for difference | Data analysis for Newquay University Centre" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://newquay-university-centre.github.io/r4nqy/images/logo/newquay_uc.png" />
  <meta property="og:description" content="A work in progress" />
  <meta name="github-repo" content="Newquay-University-Centre/r4nqy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Paired tests for difference | Data analysis for Newquay University Centre" />
  
  <meta name="twitter:description" content="A work in progress" />
  <meta name="twitter:image" content="https://newquay-university-centre.github.io/r4nqy/images/logo/newquay_uc.png" />

<meta name="author" content="Michael Hunt" />


<meta name="date" content="2024-06-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="difference.html"/>
<link rel="next" href="anova-two-way.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Newquay University Centre</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#usage"><i class="fa fa-check"></i><b>0.1</b> Usage</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#render-book"><i class="fa fa-check"></i><b>0.2</b> Render book</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#preview-book"><i class="fa fa-check"></i><b>0.3</b> Preview book</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html"><i class="fa fa-check"></i><b>1</b> Plot your data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#load-packages"><i class="fa fa-check"></i><b>1.1</b> Load packages</a></li>
<li class="chapter" data-level="1.2" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#get-the-template-script"><i class="fa fa-check"></i><b>1.2</b> Get the template script</a></li>
<li class="chapter" data-level="1.3" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#load-the-palmer-penguin-data"><i class="fa fa-check"></i><b>1.3</b> Load the Palmer penguin data</a></li>
<li class="chapter" data-level="1.4" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#summary-stats-on-all-the-numeric-columns"><i class="fa fa-check"></i><b>1.4</b> Summary stats on all the numeric columns</a></li>
<li class="chapter" data-level="1.5" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#remove-the-rows-with-nas"><i class="fa fa-check"></i><b>1.5</b> Remove the rows with NAs</a></li>
<li class="chapter" data-level="1.6" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#how-many-observations-are-there-for-each-species"><i class="fa fa-check"></i><b>1.6</b> How many observations are there for each species?</a></li>
<li class="chapter" data-level="1.7" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#mean-value-for-each-numerical-variable-for-each-species"><i class="fa fa-check"></i><b>1.7</b> Mean value for each numerical variable, for each species</a></li>
<li class="chapter" data-level="1.8" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#scatter-plots"><i class="fa fa-check"></i><b>1.8</b> Scatter plots</a></li>
<li class="chapter" data-level="1.9" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#repeat-for-bill-length-and-flipper-length"><i class="fa fa-check"></i><b>1.9</b> Repeat for bill length and flipper length</a></li>
<li class="chapter" data-level="1.10" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#add-yet-more-informtion-to-the-plot"><i class="fa fa-check"></i><b>1.10</b> Add yet more informtion to the plot</a></li>
<li class="chapter" data-level="1.11" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#distribution-of-penguin-flipper-lengths"><i class="fa fa-check"></i><b>1.11</b> Distribution of penguin flipper lengths</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#histogram"><i class="fa fa-check"></i><b>1.11.1</b> Histogram</a></li>
<li class="chapter" data-level="1.11.2" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#density-plot"><i class="fa fa-check"></i><b>1.11.2</b> Density plot</a></li>
<li class="chapter" data-level="1.11.3" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>1.11.3</b> Box plots</a></li>
<li class="chapter" data-level="1.11.4" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#violin-plot-using-geom_violin"><i class="fa fa-check"></i><b>1.11.4</b> Violin Plot using <code>geom_violin()</code></a></li>
<li class="chapter" data-level="1.11.5" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#ridge-plot"><i class="fa fa-check"></i><b>1.11.5</b> Ridge plot</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="plot-with-ggplot.html"><a href="plot-with-ggplot.html#bar-chart-with-error-bar"><i class="fa fa-check"></i><b>1.12</b> Bar chart with error bar</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chi-square.html"><a href="chi-square.html"><i class="fa fa-check"></i><b>2</b> Chi-square analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chi-square.html"><a href="chi-square.html#chi-square-goodness-of-fit-test"><i class="fa fa-check"></i><b>2.1</b> Chi-square goodness of fit test</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chi-square.html"><a href="chi-square.html#example"><i class="fa fa-check"></i><b>2.1.1</b> Example</a></li>
<li class="chapter" data-level="2.1.2" data-path="chi-square.html"><a href="chi-square.html#doing-the-chi-square-test-in-r"><i class="fa fa-check"></i><b>2.1.2</b> Doing the chi-square test in R</a></li>
<li class="chapter" data-level="2.1.3" data-path="chi-square.html"><a href="chi-square.html#reporting-the-result-in-english"><i class="fa fa-check"></i><b>2.1.3</b> Reporting the result in English</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chi-square.html"><a href="chi-square.html#exercise-1."><i class="fa fa-check"></i><b>2.2</b> Exercise 1.</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chi-square.html"><a href="chi-square.html#solution.-1"><i class="fa fa-check"></i><b>2.2.1</b> Solution. 1</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chi-square.html"><a href="chi-square.html#way-chi-square-analysis-test-of-independence"><i class="fa fa-check"></i><b>2.3</b> 2-way chi square analysis: test of independence</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chi-square.html"><a href="chi-square.html#hypotheses"><i class="fa fa-check"></i><b>2.3.1</b> Hypotheses</a></li>
<li class="chapter" data-level="2.3.2" data-path="chi-square.html"><a href="chi-square.html#summarise-the-data."><i class="fa fa-check"></i><b>2.3.2</b> Summarise the data.</a></li>
<li class="chapter" data-level="2.3.3" data-path="chi-square.html"><a href="chi-square.html#plot-the-data."><i class="fa fa-check"></i><b>2.3.3</b> Plot the data.</a></li>
<li class="chapter" data-level="2.3.4" data-path="chi-square.html"><a href="chi-square.html#interpret-the-graph-before-we-do-any-stats"><i class="fa fa-check"></i><b>2.3.4</b> Interpret the graph before we do any ‘stats’</a></li>
<li class="chapter" data-level="2.3.5" data-path="chi-square.html"><a href="chi-square.html#the-chi-square-test"><i class="fa fa-check"></i><b>2.3.5</b> The Chi-square test</a></li>
<li class="chapter" data-level="2.3.6" data-path="chi-square.html"><a href="chi-square.html#yates-continuity-correction"><i class="fa fa-check"></i><b>2.3.6</b> Yates continuity correction</a></li>
<li class="chapter" data-level="2.3.7" data-path="chi-square.html"><a href="chi-square.html#conclusion"><i class="fa fa-check"></i><b>2.3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chi-square.html"><a href="chi-square.html#the-chi-square-test-explained-advanced"><i class="fa fa-check"></i><b>2.4</b> The Chi-Square Test explained (advanced)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="chi-square.html"><a href="chi-square.html#why-does-the-test-statistic-have-this-distribution"><i class="fa fa-check"></i><b>2.4.1</b> Why does the test statistic have this distribution?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html"><i class="fa fa-check"></i><b>3</b> Fisher’s exact test</a>
<ul>
<li class="chapter" data-level="3.1" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#the-hypergeometric-function"><i class="fa fa-check"></i><b>3.1</b> The Hypergeometric Function</a></li>
<li class="chapter" data-level="3.2" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#hypergeometric-distribution-in-r"><i class="fa fa-check"></i><b>3.2</b> Hypergeometric Distribution in R</a></li>
<li class="chapter" data-level="3.3" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#back-to-fishers-exact-test"><i class="fa fa-check"></i><b>3.3</b> Back to Fisher’s Exact Test</a></li>
<li class="chapter" data-level="3.4" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#example-1"><i class="fa fa-check"></i><b>3.4</b> Example</a></li>
<li class="chapter" data-level="3.5" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#fishers-exact-test-in-r"><i class="fa fa-check"></i><b>3.5</b> Fisher’s Exact Test in R</a></li>
<li class="chapter" data-level="3.6" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#what-if-we-just-use-a-chi-square-test"><i class="fa fa-check"></i><b>3.6</b> What if we just use a chi-square test?</a></li>
<li class="chapter" data-level="3.7" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#why-not-always-use-fishers-exact-test-instead-of-a-chi-square-test"><i class="fa fa-check"></i><b>3.7</b> Why not always use Fisher’s Exact Test instead of a chi-square test?</a></li>
<li class="chapter" data-level="3.8" data-path="fishers-exact-test.html"><a href="fishers-exact-test.html#another-cautionary-note"><i class="fa fa-check"></i><b>3.8</b> Another Cautionary Note</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="difference.html"><a href="difference.html"><i class="fa fa-check"></i><b>4</b> t-test for difference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="difference.html"><a href="difference.html#preliminaries"><i class="fa fa-check"></i><b>4.1</b> Preliminaries</a></li>
<li class="chapter" data-level="4.2" data-path="difference.html"><a href="difference.html#motivation-and-example"><i class="fa fa-check"></i><b>4.2</b> Motivation and example</a></li>
<li class="chapter" data-level="4.3" data-path="difference.html"><a href="difference.html#the-two-sample-t-test"><i class="fa fa-check"></i><b>4.3</b> The two-sample <em>t</em>-test</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="difference.html"><a href="difference.html#pros-of-the-t-test"><i class="fa fa-check"></i><b>4.3.1</b> Pros of the <em>t</em>-test</a></li>
<li class="chapter" data-level="4.3.2" data-path="difference.html"><a href="difference.html#cons-of-the-t-test"><i class="fa fa-check"></i><b>4.3.2</b> Cons of the <em>t</em>-test</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="difference.html"><a href="difference.html#the-workflow"><i class="fa fa-check"></i><b>4.4</b> The workflow</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="difference.html"><a href="difference.html#open-your-project"><i class="fa fa-check"></i><b>4.4.1</b> Open your project</a></li>
<li class="chapter" data-level="4.4.2" data-path="difference.html"><a href="difference.html#create-a-new-script"><i class="fa fa-check"></i><b>4.4.2</b> Create a new script</a></li>
<li class="chapter" data-level="4.4.3" data-path="difference.html"><a href="difference.html#load-packages-1"><i class="fa fa-check"></i><b>4.4.3</b> Load packages</a></li>
<li class="chapter" data-level="4.4.4" data-path="difference.html"><a href="difference.html#read-in-and-inspect-the-data"><i class="fa fa-check"></i><b>4.4.4</b> Read in and inspect the data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="difference.html"><a href="difference.html#step-one-summarise-the-data"><i class="fa fa-check"></i><b>4.5</b> Step One: Summarise the data</a></li>
<li class="chapter" data-level="4.6" data-path="difference.html"><a href="difference.html#step-two-plot-the-data"><i class="fa fa-check"></i><b>4.6</b> Step Two: Plot the data</a></li>
<li class="chapter" data-level="4.7" data-path="difference.html"><a href="difference.html#step-three-carry-out-statistical-analysis"><i class="fa fa-check"></i><b>4.7</b> Step Three: Carry out statistical analysis</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="difference.html"><a href="difference.html#are-the-data-normally-distributed"><i class="fa fa-check"></i><b>4.7.1</b> Are the data normally distributed?</a></li>
<li class="chapter" data-level="4.7.2" data-path="difference.html"><a href="difference.html#normality-test---analytical-method"><i class="fa fa-check"></i><b>4.7.2</b> Normality test - analytical method</a></li>
<li class="chapter" data-level="4.7.3" data-path="difference.html"><a href="difference.html#graphical-methods---the-quantile-quantile-or-qq-plot."><i class="fa fa-check"></i><b>4.7.3</b> Graphical methods - the quantile-quantile or QQ plot.</a></li>
<li class="chapter" data-level="4.7.4" data-path="difference.html"><a href="difference.html#the-thinking-about-the-data-normality-test"><i class="fa fa-check"></i><b>4.7.4</b> The ‘thinking about the data’ normality test</a></li>
<li class="chapter" data-level="4.7.5" data-path="difference.html"><a href="difference.html#now-for-the-actual-two-sample-t-test"><i class="fa fa-check"></i><b>4.7.5</b> Now for the actual two-sample <em>t</em>-test</a></li>
<li class="chapter" data-level="4.7.6" data-path="difference.html"><a href="difference.html#interpret-the-output-of-the-t-test."><i class="fa fa-check"></i><b>4.7.6</b> Interpret the output of the <em>t</em>-test.</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="difference.html"><a href="difference.html#the-complete-script"><i class="fa fa-check"></i><b>4.8</b> The complete script</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html"><i class="fa fa-check"></i><b>5</b> Paired tests for difference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#which-test-paired-t-test-or-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.1</b> Which test: paired t-test or Wilcoxon signed rank test?</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#the-paired-t-test"><i class="fa fa-check"></i><b>5.1.1</b> The paired t-test</a></li>
<li class="chapter" data-level="5.1.2" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#the-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.1.2</b> The Wilcoxon Signed Rank test</a></li>
<li class="chapter" data-level="5.1.3" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#null-hypotheses"><i class="fa fa-check"></i><b>5.1.3</b> Null Hypotheses</a></li>
<li class="chapter" data-level="5.1.4" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#test-output"><i class="fa fa-check"></i><b>5.1.4</b> Test output</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#example-2"><i class="fa fa-check"></i><b>5.2</b> Example</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#load-packages-2"><i class="fa fa-check"></i><b>5.2.1</b> Load packages</a></li>
<li class="chapter" data-level="5.2.2" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#load-data"><i class="fa fa-check"></i><b>5.2.2</b> Load data</a></li>
<li class="chapter" data-level="5.2.3" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#plot-the-data"><i class="fa fa-check"></i><b>5.2.3</b> Plot the data</a></li>
<li class="chapter" data-level="5.2.4" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#tidy-the-data"><i class="fa fa-check"></i><b>5.2.4</b> Tidy the data</a></li>
<li class="chapter" data-level="5.2.5" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#check-for-normality-of-differences"><i class="fa fa-check"></i><b>5.2.5</b> Check for normality of differences</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#the-non-parametric-alternative-the-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>5.3</b> The non-parametric alternative: The Wilcoxon signed rank test</a></li>
<li class="chapter" data-level="5.4" data-path="paired-tests-for-difference.html"><a href="paired-tests-for-difference.html#relation-to-one-sample-paired-test"><i class="fa fa-check"></i><b>5.4</b> Relation to one-sample paired test</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="anova-two-way.html"><a href="anova-two-way.html"><i class="fa fa-check"></i><b>6</b> ANOVA: Two-way factorial experiments and model simplification</a>
<ul>
<li class="chapter" data-level="6.1" data-path="anova-two-way.html"><a href="anova-two-way.html#factorial-experiments-and-model-simplification"><i class="fa fa-check"></i><b>6.1</b> Factorial experiments and model simplification</a></li>
<li class="chapter" data-level="6.2" data-path="anova-two-way.html"><a href="anova-two-way.html#files-needed"><i class="fa fa-check"></i><b>6.2</b> Files needed</a></li>
<li class="chapter" data-level="6.3" data-path="anova-two-way.html"><a href="anova-two-way.html#open-your-project-1"><i class="fa fa-check"></i><b>6.3</b> Open your Project</a></li>
<li class="chapter" data-level="6.4" data-path="anova-two-way.html"><a href="anova-two-way.html#load-packages-3"><i class="fa fa-check"></i><b>6.4</b> Load packages</a></li>
<li class="chapter" data-level="6.5" data-path="anova-two-way.html"><a href="anova-two-way.html#read-in-the-data"><i class="fa fa-check"></i><b>6.5</b> Read in the data</a></li>
<li class="chapter" data-level="6.6" data-path="anova-two-way.html"><a href="anova-two-way.html#make-r-recognise-the-categorical-variables-as-factors-and-order-the-levels."><i class="fa fa-check"></i><b>6.6</b> Make R recognise the categorical variables as factors, and order the levels.</a></li>
<li class="chapter" data-level="6.7" data-path="anova-two-way.html"><a href="anova-two-way.html#summarise-the-data"><i class="fa fa-check"></i><b>6.7</b> Summarise the data</a></li>
<li class="chapter" data-level="6.8" data-path="anova-two-way.html"><a href="anova-two-way.html#plot-the-data-1"><i class="fa fa-check"></i><b>6.8</b> Plot the data</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="anova-two-way.html"><a href="anova-two-way.html#questions"><i class="fa fa-check"></i><b>6.8.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="anova-two-way.html"><a href="anova-two-way.html#anova"><i class="fa fa-check"></i><b>6.9</b> ANOVA</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="anova-two-way.html"><a href="anova-two-way.html#construct-the-model"><i class="fa fa-check"></i><b>6.9.1</b> Construct the model</a></li>
<li class="chapter" data-level="6.9.2" data-path="anova-two-way.html"><a href="anova-two-way.html#do-we-reject-the-null-hypothesis"><i class="fa fa-check"></i><b>6.9.2</b> Do we reject the null hypothesis?</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="anova-two-way.html"><a href="anova-two-way.html#model-simplification"><i class="fa fa-check"></i><b>6.10</b> Model Simplification</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="anova-two-way.html"><a href="anova-two-way.html#check-the-validity-of-the-linear-model"><i class="fa fa-check"></i><b>6.10.1</b> Check the validity of the linear model</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="anova-two-way.html"><a href="anova-two-way.html#reporting-the-results"><i class="fa fa-check"></i><b>6.11</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="anova-one-way.html"><a href="anova-one-way.html"><i class="fa fa-check"></i><b>7</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="7.1" data-path="anova-one-way.html"><a href="anova-one-way.html#load-packages-4"><i class="fa fa-check"></i><b>7.1</b> Load packages</a></li>
<li class="chapter" data-level="7.2" data-path="anova-one-way.html"><a href="anova-one-way.html#remove-observations-with-missing-values"><i class="fa fa-check"></i><b>7.2</b> Remove observations with missing values</a></li>
<li class="chapter" data-level="7.3" data-path="anova-one-way.html"><a href="anova-one-way.html#summary---group-by-species-and-sex"><i class="fa fa-check"></i><b>7.3</b> Summary - group by species and sex</a></li>
<li class="chapter" data-level="7.4" data-path="anova-one-way.html"><a href="anova-one-way.html#plot-the-data-2"><i class="fa fa-check"></i><b>7.4</b> Plot the data</a></li>
<li class="chapter" data-level="7.5" data-path="anova-one-way.html"><a href="anova-one-way.html#one-way-anova"><i class="fa fa-check"></i><b>7.5</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="anova-one-way.html"><a href="anova-one-way.html#null-hypothesis"><i class="fa fa-check"></i><b>7.5.1</b> Null hypothesis</a></li>
<li class="chapter" data-level="7.5.2" data-path="anova-one-way.html"><a href="anova-one-way.html#the-actual-anova"><i class="fa fa-check"></i><b>7.5.2</b> The actual ANOVA</a></li>
<li class="chapter" data-level="7.5.3" data-path="anova-one-way.html"><a href="anova-one-way.html#construct-the-model-1"><i class="fa fa-check"></i><b>7.5.3</b> Construct the model</a></li>
<li class="chapter" data-level="7.5.4" data-path="anova-one-way.html"><a href="anova-one-way.html#is-the-model-valid"><i class="fa fa-check"></i><b>7.5.4</b> Is the model valid?</a></li>
<li class="chapter" data-level="7.5.5" data-path="anova-one-way.html"><a href="anova-one-way.html#the-overall-picture"><i class="fa fa-check"></i><b>7.5.5</b> The overall picture</a></li>
<li class="chapter" data-level="7.5.6" data-path="anova-one-way.html"><a href="anova-one-way.html#the-detailed-picture"><i class="fa fa-check"></i><b>7.5.6</b> The detailed picture</a></li>
<li class="chapter" data-level="7.5.7" data-path="anova-one-way.html"><a href="anova-one-way.html#post-hoc-tsts."><i class="fa fa-check"></i><b>7.5.7</b> Post hoc tsts.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="anova-one-way.html"><a href="anova-one-way.html#reporting-the-result."><i class="fa fa-check"></i><b>7.6</b> Reporting the Result.</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>8</b> Correlation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="correlation.html"><a href="correlation.html#the-correlation-coefficient"><i class="fa fa-check"></i><b>8.1</b> The correlation coefficient</a></li>
<li class="chapter" data-level="8.2" data-path="correlation.html"><a href="correlation.html#different-values-of-r."><i class="fa fa-check"></i><b>8.2</b> Different values of <em>r</em>.</a></li>
<li class="chapter" data-level="8.3" data-path="correlation.html"><a href="correlation.html#using-r-to-find-the-correlation-coefficient."><i class="fa fa-check"></i><b>8.3</b> Using R to find the correlation coefficient.</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="correlation.html"><a href="correlation.html#correlations-for-real-data"><i class="fa fa-check"></i><b>8.3.1</b> Correlations for real data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="correlation.html"><a href="correlation.html#the-correlation-coefficient-measures-the-degree-of-linear-association."><i class="fa fa-check"></i><b>8.4</b> The correlation coefficient measures the degree of linear association.</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="correlation.html"><a href="correlation.html#when-is-it-appropriate-to-calculate-a-correlation-coefficient"><i class="fa fa-check"></i><b>8.4.1</b> When is it appropriate to calculate a correlation coefficient?</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="correlation.html"><a href="correlation.html#association-is-not-causation"><i class="fa fa-check"></i><b>8.5</b> Association is not causation</a></li>
<li class="chapter" data-level="8.6" data-path="correlation.html"><a href="correlation.html#examples"><i class="fa fa-check"></i><b>8.6</b> Examples</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="correlation.html"><a href="correlation.html#lichen-abundance"><i class="fa fa-check"></i><b>8.6.1</b> Lichen abundance</a></li>
<li class="chapter" data-level="8.6.2" data-path="correlation.html"><a href="correlation.html#soil-bacteria"><i class="fa fa-check"></i><b>8.6.2</b> Soil bacteria</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="correlation.html"><a href="correlation.html#exercises"><i class="fa fa-check"></i><b>8.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="correlation.html"><a href="correlation.html#exercise-1"><i class="fa fa-check"></i><b>8.7.1</b> Exercise 1</a></li>
<li class="chapter" data-level="8.7.2" data-path="correlation.html"><a href="correlation.html#exercise-2"><i class="fa fa-check"></i><b>8.7.2</b> Exercise 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html"><i class="fa fa-check"></i><b>9</b> Simple linear regression {#linear regression}</a>
<ul>
<li class="chapter" data-level="9.1" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="9.2" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#load-packages-5"><i class="fa fa-check"></i><b>9.2</b> Load packages</a></li>
<li class="chapter" data-level="9.3" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#get-the-data"><i class="fa fa-check"></i><b>9.3</b> Get the data</a></li>
<li class="chapter" data-level="9.4" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#plot-the-data-3"><i class="fa fa-check"></i><b>9.4</b> Plot the data</a></li>
<li class="chapter" data-level="9.5" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#make-a-simple-model-using-linear-regression"><i class="fa fa-check"></i><b>9.5</b> Make a simple model using linear regression</a></li>
<li class="chapter" data-level="9.6" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#check-assumptions"><i class="fa fa-check"></i><b>9.6</b> Check assumptions</a></li>
<li class="chapter" data-level="9.7" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#interpretation-of-the-model"><i class="fa fa-check"></i><b>9.7</b> Interpretation of the model</a></li>
<li class="chapter" data-level="9.8" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#back-to-the-figure"><i class="fa fa-check"></i><b>9.8</b> Back to the figure</a></li>
<li class="chapter" data-level="9.9" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#conclusion-1"><i class="fa fa-check"></i><b>9.9</b> Conclusion</a></li>
<li class="chapter" data-level="9.10" data-path="simple-linear-regression-linear-regression.html"><a href="simple-linear-regression-linear-regression.html#sample-script"><i class="fa fa-check"></i><b>9.10</b> Sample script</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html"><i class="fa fa-check"></i><b>A</b> A primer in statistics</a>
<ul>
<li class="chapter" data-level="A.1" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#populations-and-samples"><i class="fa fa-check"></i><b>A.1</b> Populations and samples</a></li>
<li class="chapter" data-level="A.2" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#three-types-of-variability-of-the-sample-of-the-population-and-of-the-estimate."><i class="fa fa-check"></i><b>A.2</b> Three types of variability: of the sample, of the population and of the estimate.</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#variability-of-the-sample"><i class="fa fa-check"></i><b>A.2.1</b> Variability of the sample</a></li>
<li class="chapter" data-level="A.2.2" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#variability-of-the-population"><i class="fa fa-check"></i><b>A.2.2</b> Variability of the population</a></li>
<li class="chapter" data-level="A.2.3" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#variability-of-the-estimate"><i class="fa fa-check"></i><b>A.2.3</b> Variability of the estimate</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#confidence-intervals-a-way-of-precisely-representing-uncertainty"><i class="fa fa-check"></i><b>A.3</b> Confidence intervals: a way of precisely representing uncertainty</a></li>
<li class="chapter" data-level="A.4" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>A.4</b> The <span class="math inline">\(t\)</span>-distribution</a></li>
<li class="chapter" data-level="A.5" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#hypothesis-testing"><i class="fa fa-check"></i><b>A.5</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#general-procedure-for-a-hypothesis-test"><i class="fa fa-check"></i><b>A.5.1</b> General procedure for a hypothesis test</a></li>
<li class="chapter" data-level="A.5.2" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#comparing-one-mean-with-a-threshold---one-sample-t-test"><i class="fa fa-check"></i><b>A.5.2</b> Comparing one mean with a threshold - one sample <em>t</em>-test</a></li>
<li class="chapter" data-level="A.5.3" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#comparing-two-means---two-sample-test"><i class="fa fa-check"></i><b>A.5.3</b> Comparing two means - two-sample test</a></li>
<li class="chapter" data-level="A.5.4" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#alternatives-to-the-t-test"><i class="fa fa-check"></i><b>A.5.4</b> Alternatives to the <em>t</em>-test</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="a-primer-in-statistics.html"><a href="a-primer-in-statistics.html#size-effects-vs-hypothesis-testing."><i class="fa fa-check"></i><b>A.6</b> Size effects vs hypothesis testing.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data analysis for Newquay University Centre</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="paired-tests-for-difference" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Paired tests for difference<a href="paired-tests-for-difference.html#paired-tests-for-difference" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Often one has a sample of replicated data where each element has a counterpart in another matched sample - paired data. A common scenario for this is when there are data for the same individual at two different points in time, for example before and after some event such as the application of a treatment.</p>
<p>In order to determine whether there is a difference between the two sets, one should take the paired aspect into account and not simply match the whole before-set against the whole after-set without doing this. That would be to throw away the information whereby there is likely to be a greater degree of correlation between the responses of an individual before and after the event than there is between any randomly chosen pairs of individuals before and after the event.</p>
<div id="which-test-paired-t-test-or-wilcoxon-signed-rank-test" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Which test: paired t-test or Wilcoxon signed rank test?<a href="paired-tests-for-difference.html#which-test-paired-t-test-or-wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There is a choice between at least two tests: the parametric paired t-test and the non-parametric Wilcoxon signed rank test. Ideally one would use the t-test since it is more powerful than the Wilcoxon test. This means several things, but in particular it means that, all else being equal, it can detect a small difference with higher probability than the Wilcoxon test can.</p>
<div id="the-paired-t-test" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> The paired t-test<a href="paired-tests-for-difference.html#the-paired-t-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Where the data are numerical (ie not ordinal) and where the before and after data are both normally distributed around their respective mean values one would use the <em>paired t-test</em> in this scenario. One can test for normality using either a test such as the Shapiro-Wilk test, or graphically using either a histogram, a box plot, or (best), a quantile-quantile plot.</p>
</div>
<div id="the-wilcoxon-signed-rank-test" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> The Wilcoxon Signed Rank test<a href="paired-tests-for-difference.html#the-wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The t-test, an example of a so-called parametric test, is actually pretty robust against departures from normality, but where one doubts its validity due to extreme non-normality or for other reasons such as the ordinal nature of the data, the Wilcoxon signed rank test is a useful non-parametric alternative. It is called non-parametric because it does not make any assumption about the distribution of the data values. It only uses their ranks, where the smallest value gets rank 1, the next smallest gets rank 2, and so on.</p>
<p>So, you typically use this test when you would like to use the paired t-test, but you cannot because one or both of the data sets is way off being normally distributed or is ordinal.</p>
</div>
<div id="null-hypotheses" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Null Hypotheses<a href="paired-tests-for-difference.html#null-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In both the t-test and the Wilcoxon signed rank tests, the null hypothesis is the usual ‘nothing going on’, ‘there is no difference’ scenario, but there is a subtle difference between them that reflects the different information that they use. In the Wilcoxon signed rank test the null is that the difference between the <em>medians</em> of pairs of observations is zero. This is different from the null hypothesis of the paired t–test, which is that the difference between the <em>means</em> of pairs is zero.</p>
</div>
<div id="test-output" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Test output<a href="paired-tests-for-difference.html#test-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Both tests will give a p value. This is the probability that the mean (t-test) or median (Wilcoxon signed rank) paired differences between the corresponding before and after sample elements would be equal to or greater than it actually is for the data if the null hypothesis were true. If the p value is less than some pre-decided ‘significance level’, usually taken to be 0.05, then we reject the null hypothesis. If it is not, then we fail to reject the null hypothesis.</p>
</div>
</div>
<div id="example-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Example<a href="paired-tests-for-difference.html#example-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will use as an example a data set from Laureysens et al. (2004) that has measurements of metal content in the wood of 13 poplar clones growing in a polluted area, once in August and once in November. The idea was to investigate the extent to which poplars could absorb metals from the soil and thus be useful in cleaning that up. Under a null hypothesis, there would be no difference between the metal concentrations in the plant tissue between August and November. Under an alternate hypothesis, there would be.</p>
<p>Laureysens, I. et al. (2004) ‘Clonal variation in heavy metal accumulation and biomass production in a poplar coppice culture: I. Seasonal variation in leaf, wood and bark concentrations’, Environmental Pollution, 131(3), pp. 485–494. Available at: <a href="https://doi.org/10.1016/j.envpol.2004.02.009" class="uri">https://doi.org/10.1016/j.envpol.2004.02.009</a>.</p>
<p>Concentrations of aluminum (in micrograms of Al per gram of wood) are shown below.</p>
<div id="load-packages-2" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Load packages<a href="paired-tests-for-difference.html#load-packages-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="paired-tests-for-difference.html#cb91-1" tabindex="-1"></a><span class="fu">library</span> (tidyverse)</span>
<span id="cb91-2"><a href="paired-tests-for-difference.html#cb91-2" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb91-3"><a href="paired-tests-for-difference.html#cb91-3" tabindex="-1"></a><span class="fu">library</span>(cowplot) <span class="co"># to make the plots look nice</span></span>
<span id="cb91-4"><a href="paired-tests-for-difference.html#cb91-4" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># for making nice tables</span></span></code></pre></div>
</div>
<div id="load-data" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Load data<a href="paired-tests-for-difference.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="paired-tests-for-difference.html#cb92-1" tabindex="-1"></a>filepath <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="st">&quot;data&quot;</span>,<span class="st">&quot;poplars-paired_np.csv&quot;</span>)</span>
<span id="cb92-2"><a href="paired-tests-for-difference.html#cb92-2" tabindex="-1"></a>poplars <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(filepath,<span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="paired-tests-for-difference.html#cb93-1" tabindex="-1"></a><span class="co"># table of the data</span></span>
<span id="cb93-2"><a href="paired-tests-for-difference.html#cb93-2" tabindex="-1"></a>poplars <span class="sc">|&gt;</span></span>
<span id="cb93-3"><a href="paired-tests-for-difference.html#cb93-3" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="jraakwkhrn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jraakwkhrn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jraakwkhrn thead, #jraakwkhrn tbody, #jraakwkhrn tfoot, #jraakwkhrn tr, #jraakwkhrn td, #jraakwkhrn th {
  border-style: none;
}

#jraakwkhrn p {
  margin: 0;
  padding: 0;
}

#jraakwkhrn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jraakwkhrn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jraakwkhrn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jraakwkhrn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jraakwkhrn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jraakwkhrn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jraakwkhrn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jraakwkhrn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jraakwkhrn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jraakwkhrn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jraakwkhrn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jraakwkhrn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jraakwkhrn .gt_spanner_row {
  border-bottom-style: hidden;
}

#jraakwkhrn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jraakwkhrn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jraakwkhrn .gt_from_md > :first-child {
  margin-top: 0;
}

#jraakwkhrn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jraakwkhrn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jraakwkhrn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jraakwkhrn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jraakwkhrn .gt_row_group_first td {
  border-top-width: 2px;
}

#jraakwkhrn .gt_row_group_first th {
  border-top-width: 2px;
}

#jraakwkhrn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jraakwkhrn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jraakwkhrn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jraakwkhrn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jraakwkhrn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jraakwkhrn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jraakwkhrn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jraakwkhrn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jraakwkhrn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jraakwkhrn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jraakwkhrn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jraakwkhrn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jraakwkhrn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jraakwkhrn .gt_left {
  text-align: left;
}

#jraakwkhrn .gt_center {
  text-align: center;
}

#jraakwkhrn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jraakwkhrn .gt_font_normal {
  font-weight: normal;
}

#jraakwkhrn .gt_font_bold {
  font-weight: bold;
}

#jraakwkhrn .gt_font_italic {
  font-style: italic;
}

#jraakwkhrn .gt_super {
  font-size: 65%;
}

#jraakwkhrn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jraakwkhrn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jraakwkhrn .gt_indent_1 {
  text-indent: 5px;
}

#jraakwkhrn .gt_indent_2 {
  text-indent: 10px;
}

#jraakwkhrn .gt_indent_3 {
  text-indent: 15px;
}

#jraakwkhrn .gt_indent_4 {
  text-indent: 20px;
}

#jraakwkhrn .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Clone">Clone</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="August">August</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="November">November</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="Clone" class="gt_row gt_left">Balsam_Spire</td>
<td headers="August" class="gt_row gt_right">8.1</td>
<td headers="November" class="gt_row gt_right">11.2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="Clone" class="gt_row gt_left">Beaupre</td>
<td headers="August" class="gt_row gt_right">10.0</td>
<td headers="November" class="gt_row gt_right">16.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="Clone" class="gt_row gt_left">Hazendans</td>
<td headers="August" class="gt_row gt_right">16.5</td>
<td headers="November" class="gt_row gt_right">15.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="Clone" class="gt_row gt_left">Hoogvorst</td>
<td headers="August" class="gt_row gt_right">13.6</td>
<td headers="November" class="gt_row gt_right">15.6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">5</td>
<td headers="Clone" class="gt_row gt_left">Raspalje</td>
<td headers="August" class="gt_row gt_right">9.5</td>
<td headers="November" class="gt_row gt_right">10.5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">6</td>
<td headers="Clone" class="gt_row gt_left">Unal</td>
<td headers="August" class="gt_row gt_right">8.3</td>
<td headers="November" class="gt_row gt_right">15.5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">7</td>
<td headers="Clone" class="gt_row gt_left">Columbia_River</td>
<td headers="August" class="gt_row gt_right">18.3</td>
<td headers="November" class="gt_row gt_right">12.7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">8</td>
<td headers="Clone" class="gt_row gt_left">Fritzi_Pauley</td>
<td headers="August" class="gt_row gt_right">13.3</td>
<td headers="November" class="gt_row gt_right">11.1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">9</td>
<td headers="Clone" class="gt_row gt_left">Trichobel</td>
<td headers="August" class="gt_row gt_right">7.9</td>
<td headers="November" class="gt_row gt_right">19.9</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">10</td>
<td headers="Clone" class="gt_row gt_left">Gaver</td>
<td headers="August" class="gt_row gt_right">8.1</td>
<td headers="November" class="gt_row gt_right">20.4</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">11</td>
<td headers="Clone" class="gt_row gt_left">Gibecq</td>
<td headers="August" class="gt_row gt_right">8.9</td>
<td headers="November" class="gt_row gt_right">14.2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">12</td>
<td headers="Clone" class="gt_row gt_left">Primo</td>
<td headers="August" class="gt_row gt_right">12.6</td>
<td headers="November" class="gt_row gt_right">12.7</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">13</td>
<td headers="Clone" class="gt_row gt_left">Wolterson</td>
<td headers="August" class="gt_row gt_right">13.4</td>
<td headers="November" class="gt_row gt_right">36.8</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="plot-the-data" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Plot the data<a href="paired-tests-for-difference.html#plot-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we do any test on some data to find evidence for a difference or a trend, it is a good idea to plot the data. This will reveal whatever patterns there are in the data and how likely they are to reveal a truth about the population from which they have been drawn.</p>
</div>
<div id="tidy-the-data" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Tidy the data<a href="paired-tests-for-difference.html#tidy-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this case there is work to do before we can plot the data. The problem is that the data is ‘untidy’. The two levels of the factor <code>month</code> are spread across two columns, August and November. For plotting purposes it will be useful to ‘tidy’ the data so that there is only one column containing both levels of <code>month</code> and another containing the aluminium concentrations. The function <code>pivot_longer()</code> can do this for us:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="paired-tests-for-difference.html#cb94-1" tabindex="-1"></a>poplars_tidy <span class="ot">&lt;-</span> poplars <span class="sc">|&gt;</span></span>
<span id="cb94-2"><a href="paired-tests-for-difference.html#cb94-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span> (August<span class="sc">:</span>November,<span class="at">names_to=</span><span class="st">&quot;month&quot;</span>,<span class="at">values_to=</span><span class="st">&quot;Al_conc&quot;</span>)</span>
<span id="cb94-3"><a href="paired-tests-for-difference.html#cb94-3" tabindex="-1"></a><span class="fu">head</span>(poplars_tidy,<span class="dv">8</span>) <span class="sc">|&gt;</span></span>
<span id="cb94-4"><a href="paired-tests-for-difference.html#cb94-4" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="kydsnggmrv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kydsnggmrv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kydsnggmrv thead, #kydsnggmrv tbody, #kydsnggmrv tfoot, #kydsnggmrv tr, #kydsnggmrv td, #kydsnggmrv th {
  border-style: none;
}

#kydsnggmrv p {
  margin: 0;
  padding: 0;
}

#kydsnggmrv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kydsnggmrv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kydsnggmrv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kydsnggmrv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kydsnggmrv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kydsnggmrv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kydsnggmrv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kydsnggmrv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kydsnggmrv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kydsnggmrv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kydsnggmrv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kydsnggmrv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kydsnggmrv .gt_spanner_row {
  border-bottom-style: hidden;
}

#kydsnggmrv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kydsnggmrv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kydsnggmrv .gt_from_md > :first-child {
  margin-top: 0;
}

#kydsnggmrv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kydsnggmrv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kydsnggmrv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kydsnggmrv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kydsnggmrv .gt_row_group_first td {
  border-top-width: 2px;
}

#kydsnggmrv .gt_row_group_first th {
  border-top-width: 2px;
}

#kydsnggmrv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kydsnggmrv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kydsnggmrv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kydsnggmrv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kydsnggmrv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kydsnggmrv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kydsnggmrv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kydsnggmrv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kydsnggmrv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kydsnggmrv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kydsnggmrv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kydsnggmrv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kydsnggmrv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kydsnggmrv .gt_left {
  text-align: left;
}

#kydsnggmrv .gt_center {
  text-align: center;
}

#kydsnggmrv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kydsnggmrv .gt_font_normal {
  font-weight: normal;
}

#kydsnggmrv .gt_font_bold {
  font-weight: bold;
}

#kydsnggmrv .gt_font_italic {
  font-style: italic;
}

#kydsnggmrv .gt_super {
  font-size: 65%;
}

#kydsnggmrv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kydsnggmrv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kydsnggmrv .gt_indent_1 {
  text-indent: 5px;
}

#kydsnggmrv .gt_indent_2 {
  text-indent: 10px;
}

#kydsnggmrv .gt_indent_3 {
  text-indent: 15px;
}

#kydsnggmrv .gt_indent_4 {
  text-indent: 20px;
}

#kydsnggmrv .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ID">ID</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Clone">Clone</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Al_conc">Al_conc</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="Clone" class="gt_row gt_left">Balsam_Spire</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">8.1</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">1</td>
<td headers="Clone" class="gt_row gt_left">Balsam_Spire</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">11.2</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="Clone" class="gt_row gt_left">Beaupre</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">10.0</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">2</td>
<td headers="Clone" class="gt_row gt_left">Beaupre</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">16.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="Clone" class="gt_row gt_left">Hazendans</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">16.5</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">3</td>
<td headers="Clone" class="gt_row gt_left">Hazendans</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">15.3</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="Clone" class="gt_row gt_left">Hoogvorst</td>
<td headers="month" class="gt_row gt_left">August</td>
<td headers="Al_conc" class="gt_row gt_right">13.6</td></tr>
    <tr><td headers="ID" class="gt_row gt_right">4</td>
<td headers="Clone" class="gt_row gt_left">Hoogvorst</td>
<td headers="month" class="gt_row gt_left">November</td>
<td headers="Al_conc" class="gt_row gt_right">15.6</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Now we can plot the data as a box plot, with one box for August and one for November ie one for each level of the factor <code>month</code>. Had we not first tidied the data, we could not have done this.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="paired-tests-for-difference.html#cb95-1" tabindex="-1"></a>poplars_tidy <span class="sc">|&gt;</span></span>
<span id="cb95-2"><a href="paired-tests-for-difference.html#cb95-2" tabindex="-1"></a>  <span class="co"># group = ID makes the lines join elements of each pair</span></span>
<span id="cb95-3"><a href="paired-tests-for-difference.html#cb95-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> Al_conc, <span class="at">fill =</span> month, <span class="at">colour =</span> month)) <span class="sc">+</span> </span>
<span id="cb95-4"><a href="paired-tests-for-difference.html#cb95-4" tabindex="-1"></a>  <span class="co"># alpa (= opacity) &lt; 1 in case any points are on top of each other</span></span>
<span id="cb95-5"><a href="paired-tests-for-difference.html#cb95-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size=</span><span class="dv">0</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="paired-tests-for-difference.html#cb95-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb95-7"><a href="paired-tests-for-difference.html#cb95-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>ID),<span class="at">colour =</span> <span class="st">&quot;grey60&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-8"><a href="paired-tests-for-difference.html#cb95-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Month&quot;</span>,</span>
<span id="cb95-9"><a href="paired-tests-for-difference.html#cb95-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Al conc.(mu g Al / g wood)&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-10"><a href="paired-tests-for-difference.html#cb95-10" tabindex="-1"></a>  <span class="fu">theme_cowplot</span>() <span class="sc">+</span></span>
<span id="cb95-11"><a href="paired-tests-for-difference.html#cb95-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="paired_data_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Does it look as though the difference between the medians could plausibly be zero for the population? Or, put another way, if it was zero, how big a fluke would this sample be? That is what the p value actually tells us.</p>
</div>
<div id="check-for-normality-of-differences" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Check for normality of differences<a href="paired-tests-for-difference.html#check-for-normality-of-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we use the t-test, we need to check that it is OK to do so.
The null hypothesis of the Shapiro-Wilk test is that the data set given to it is drawn from a normally distributed population.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="paired-tests-for-difference.html#cb96-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(poplars<span class="sc">$</span>August<span class="sc">-</span>poplars<span class="sc">$</span>November)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  poplars$August - poplars$November
## W = 0.92667, p-value = 0.3081</code></pre>
<p>The p value is very high. Thus we can reasonably assume that the differences between the August and November aluminium concentrations in the sample could plausibly have been drawn from a normally distributed population, despite the outlier value in the November sample. Thus we can reasonably test for difference using a paired t-test.</p>
<p>We can do this in R using the function <code>t.test()</code>, where we give to the function both the August and the November data, knowing that each August value has a counterpart November value, and we set the argument <code>paired</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="paired-tests-for-difference.html#cb98-1" tabindex="-1"></a><span class="fu">t.test</span>(poplars<span class="sc">$</span>August, poplars<span class="sc">$</span>November, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  poplars$August and poplars$November
## t = -2.3089, df = 12, p-value = 0.03956
## alternative hypothesis: true mean difference is not equal to 0
## 95 percent confidence interval:
##  -9.5239348 -0.2760652
## sample estimates:
## mean difference 
##            -4.9</code></pre>
<p>All parts of the output have meaning and are useful, but here we will focus on just two:</p>
<ul>
<li>the p value is equal to 0.040. Hence, if we have chosen the usual significance value of 0.05, we can take this to mean that there is evidence of a significant difference between the August and November values.</li>
<li>the lower and upper bounds of the 95% confidence interval are (-9.52, -0.28). This tells us that if samples such as we have were collected again and again, then the mean difference between the August and the November paired values would be in this range 95% of the time. The key thing is that this range does not encompass zero. This means that we can be confident at the 95% level that there is a non-zero change on going from August to November, and, in particular, that the August value is lower than the November value.</li>
</ul>
</div>
</div>
<div id="the-non-parametric-alternative-the-wilcoxon-signed-rank-test" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The non-parametric alternative: The Wilcoxon signed rank test<a href="paired-tests-for-difference.html#the-non-parametric-alternative-the-wilcoxon-signed-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To be safe, because of that outlier, let us test for difference using the Wilcoxon signed rank test. In R this is done using the function <code>wilcox.test()</code>, with the argument <code>paired</code> set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="paired-tests-for-difference.html#cb100-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(poplars<span class="sc">$</span>August, poplars<span class="sc">$</span>November, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  poplars$August and poplars$November
## V = 16, p-value = 0.03979
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>We see that the conclusion (in this case) is the same.</p>
</div>
<div id="relation-to-one-sample-paired-test" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Relation to one-sample paired test<a href="paired-tests-for-difference.html#relation-to-one-sample-paired-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The two-sample paired tests as we have done above are the same as doing a one-sample test to see if the differences between the August and November paired values is different from zero. This is true whether we do a t-test or a Wilcoxon signed rank test.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="paired-tests-for-difference.html#cb102-1" tabindex="-1"></a><span class="fu">t.test</span>(poplars<span class="sc">$</span>August <span class="sc">-</span> poplars<span class="sc">$</span>November, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">data =</span> poplars)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  poplars$August - poplars$November
## t = -2.3089, df = 12, p-value = 0.03956
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -9.5239348 -0.2760652
## sample estimates:
## mean of x 
##      -4.9</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="paired-tests-for-difference.html#cb104-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(poplars<span class="sc">$</span>August <span class="sc">-</span> poplars<span class="sc">$</span>November, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">data =</span> poplars)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  poplars$August - poplars$November
## V = 16, p-value = 0.03979
## alternative hypothesis: true location is not equal to 0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="difference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="anova-two-way.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Newquay-University-Centre/r4nqy/edit/main/paired_data.Rmd",
"text": "Suggest an edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/Newquay-University-Centre/r4nqy/raw/main/paired_data.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
